
<!doctype html>
<html lang="fr" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Mathieu Klimczak">
      
      
      
        <link rel="prev" href="../docker/">
      
      
        <link rel="next" href="../yaml/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.0.2">
    
    
      
        <title>Kubernetes - Arctic Vault</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.f56500e0.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.2505c338.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CJetBrains+Mono+Medium:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"JetBrains Mono Medium"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="../../stylesheets/mkdocsoad.css">
    
      <link rel="stylesheet" href="../../css/ansi-colours.css">
    
      <link rel="stylesheet" href="../../css/jupyter-cells.css">
    
      <link rel="stylesheet" href="../../css/pandas-dataframe.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#kubernetes-for-the-beginner" class="md-skip">
          Aller au contenu
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="En-tête">
    <a href="../.." title="Arctic Vault" class="md-header__button md-logo" aria-label="Arctic Vault" data-md-component="logo">
      
  <img src="../../images/noun_Robot_1955251.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Arctic Vault
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Kubernetes
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Basculer en mode sombre"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Basculer en mode sombre" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
            </label>
          
        
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="deep-orange"  aria-label="Basculer en mode clair"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Basculer en mode clair" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Rechercher" placeholder="Rechercher" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Effacer" aria-label="Effacer" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initialisation de la recherche
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Onglets" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      Accueil
    </a>
  </li>

      
        
  
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../deep_learning/module1/Module1/" class="md-tabs__link">
        Deep Learning
      </a>
    </li>
  

  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../mlops/docker/" class="md-tabs__link">
        MLOps
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../azure_ml/intro/" class="md-tabs__link">
        AzureML
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../linux/" class="md-tabs__link md-tabs__link--active">
        DevOps 101
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../az104/az-ad/" class="md-tabs__link">
        AZ-104
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../ide_vscode/conf/" class="md-tabs__link">
        Guidelines
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../lectures/gradient_centralization/" class="md-tabs__link">
        Lectures
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Arctic Vault" class="md-nav__button md-logo" aria-label="Arctic Vault" data-md-component="logo">
      
  <img src="../../images/noun_Robot_1955251.svg" alt="logo">

    </a>
    Arctic Vault
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Accueil
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Deep Learning
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Deep Learning" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Deep Learning
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_1" type="checkbox" id="__nav_2_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_1">
          Introduction au deep learning, prise en main de Tensorflow et Keras
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Introduction au deep learning, prise en main de Tensorflow et Keras" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_1">
          <span class="md-nav__icon md-icon"></span>
          Introduction au deep learning, prise en main de Tensorflow et Keras
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deep_learning/module1/Module1/" class="md-nav__link">
        Théorie
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deep_learning/module1/tp1/" class="md-nav__link">
        Pratique
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_2" type="checkbox" id="__nav_2_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_2">
          Les réseaux de neurones convolutifs
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Les réseaux de neurones convolutifs" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_2">
          <span class="md-nav__icon md-icon"></span>
          Les réseaux de neurones convolutifs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deep_learning/module2/Module2/" class="md-nav__link">
        Théorie
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deep_learning/module2/module2_annexe/" class="md-nav__link">
        Annexe
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deep_learning/module2/tp2/" class="md-nav__link">
        Pratique
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_3" type="checkbox" id="__nav_2_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_3">
          Preprocessing des données avec l'API tf.data
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Preprocessing des données avec l'API tf.data" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_3">
          <span class="md-nav__icon md-icon"></span>
          Preprocessing des données avec l'API tf.data
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deep_learning/module3/Module3/" class="md-nav__link">
        Pratique
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_4" type="checkbox" id="__nav_2_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_4">
          Optimisation et régularisation des réseaux de neurones
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Optimisation et régularisation des réseaux de neurones" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_4">
          <span class="md-nav__icon md-icon"></span>
          Optimisation et régularisation des réseaux de neurones
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deep_learning/module4/Module4/" class="md-nav__link">
        Théorie
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deep_learning/module4/Module4_2/" class="md-nav__link">
        Pratique
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_5" type="checkbox" id="__nav_2_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_5">
          Personnaliser son réseau de neurones
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Personnaliser son réseau de neurones" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_5">
          <span class="md-nav__icon md-icon"></span>
          Personnaliser son réseau de neurones
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deep_learning/module5/Module5/" class="md-nav__link">
        Théorie
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deep_learning/module5/Module5_2/" class="md-nav__link">
        Pratique
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_6" type="checkbox" id="__nav_2_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_6">
          La segmentation d'images
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="La segmentation d'images" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_6">
          <span class="md-nav__icon md-icon"></span>
          La segmentation d'images
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deep_learning/module6/module6/" class="md-nav__link">
        Théorie
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deep_learning/module6/Module6_2/" class="md-nav__link">
        Pratique
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_7" type="checkbox" id="__nav_2_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_7">
          Les modèles générateurs
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Les modèles générateurs" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_7">
          <span class="md-nav__icon md-icon"></span>
          Les modèles générateurs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deep_learning/module7/Module7_2/" class="md-nav__link">
        Pratique
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_8" type="checkbox" id="__nav_2_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_8">
          Déployer son réseau de neurones sur de l'embarqué
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Déployer son réseau de neurones sur de l'embarqué" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_8">
          <span class="md-nav__icon md-icon"></span>
          Déployer son réseau de neurones sur de l'embarqué
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deep_learning/module9/module9/" class="md-nav__link">
        Théorie
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deep_learning/module9/tp9_elaguage/" class="md-nav__link">
        Pratique, l'élagage
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deep_learning/module9/tp9_tflite/" class="md-nav__link">
        Pratique, TFLite
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deep_learning/module9/Module9_TFTRT/" class="md-nav__link">
        Pratique, TFTRT
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deep_learning/module9/fusion/" class="md-nav__link">
        Annexe, RepVGG
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deep_learning/module9/bnn/" class="md-nav__link">
        Les BNN
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_9" type="checkbox" id="__nav_2_9" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_9">
          Algèbre tensorielle
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Algèbre tensorielle" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_9">
          <span class="md-nav__icon md-icon"></span>
          Algèbre tensorielle
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../algebra/algebra/" class="md-nav__link">
        Les tenseurs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../algebra/attn/" class="md-nav__link">
        L'attention
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          MLOps
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="MLOps" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          MLOps
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mlops/docker/" class="md-nav__link">
        Docker
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mlops/DVC/" class="md-nav__link">
        Data versioning
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mlops/mlem/" class="md-nav__link">
        Model Registry
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mlops/featurestore/" class="md-nav__link">
        Feature store
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mlops/hydra/" class="md-nav__link">
        Hydra
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mlops/monitoring/" class="md-nav__link">
        Monitoring
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mlops/optuna/" class="md-nav__link">
        Optimisation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mlops/image_fastapi/" class="md-nav__link">
        REST API
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          AzureML
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="AzureML" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          AzureML
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../azure_ml/intro/" class="md-nav__link">
        Introduction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../azure_ml/lesson1/" class="md-nav__link">
        SDK Azure
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../azure_ml/lesson1_project/" class="md-nav__link">
        HyperDrive et AutoML
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../azure_ml/lesson2/" class="md-nav__link">
        Déployer un modèle
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../azure_ml/lesson3/" class="md-nav__link">
        Utilisation du modèle déployé
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../azure_ml/lesson4/" class="md-nav__link">
        Pipelines
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../azure_ml/annex1/" class="md-nav__link">
        Azure et Traefik
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../azure_ml/annex2/" class="md-nav__link">
        Azure et Caddy
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          DevOps 101
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="DevOps 101" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          DevOps 101
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../linux/" class="md-nav__link">
        Linux Basics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../git/" class="md-nav__link">
        Git
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../shell/" class="md-nav__link">
        Shell scripts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../network/" class="md-nav__link">
        Networking
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../applications/" class="md-nav__link">
        Applications
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../web_server/" class="md-nav__link">
        Web Servers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../terminal/" class="md-nav__link">
        Terminal
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tls_ssl/" class="md-nav__link">
        SSL et TLS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../docker/" class="md-nav__link">
        Docker
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Kubernetes
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Kubernetes
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table des matières">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table des matières
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#orchestration" class="md-nav__link">
    Orchestration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#architecture-kubernetes" class="md-nav__link">
    Architecture kubernetes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kubectl" class="md-nav__link">
    kubectl
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installer-kubernetes" class="md-nav__link">
    Installer kubernetes
  </a>
  
    <nav class="md-nav" aria-label="Installer kubernetes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    References
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#concept-de-base-les-pods" class="md-nav__link">
    Concept de base : les Pods
  </a>
  
    <nav class="md-nav" aria-label="Concept de base : les Pods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pod-multi-conteneur" class="md-nav__link">
    POD multi-conteneur
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#les-commandes-de-base" class="md-nav__link">
    Les commandes de base
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#concepts-pods-replicasets-deployments" class="md-nav__link">
    Concepts : PODs, ReplicaSets, Deployments
  </a>
  
    <nav class="md-nav" aria-label="Concepts : PODs, ReplicaSets, Deployments">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creer-un-pod-via-yaml" class="md-nav__link">
    Créer un pod via YAML
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#replications" class="md-nav__link">
    Réplications
  </a>
  
    <nav class="md-nav" aria-label="Réplications">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#replicaset-controleur-de-replications" class="md-nav__link">
    ReplicaSet, contrôleur de réplications
  </a>
  
    <nav class="md-nav" aria-label="ReplicaSet, contrôleur de réplications">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#replicationcontroller" class="md-nav__link">
    ReplicationController
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#replicaset" class="md-nav__link">
    ReplicaSet
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#augmenter-le-nombre-de-repliques" class="md-nav__link">
    Augmenter le nombre de répliques
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deployment" class="md-nav__link">
    Deployment
  </a>
  
    <nav class="md-nav" aria-label="Deployment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#updates-et-rollback" class="md-nav__link">
    Updates et Rollback
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#notion-de-reseaux-dans-kubernetes" class="md-nav__link">
    Notion de réseaux dans kubernetes
  </a>
  
    <nav class="md-nav" aria-label="Notion de réseaux dans kubernetes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cas-dun-noeud-unique" class="md-nav__link">
    Cas d'un noeud unique
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cas-de-plusieurs-noeuds" class="md-nav__link">
    Cas de plusieurs noeuds
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#les-services" class="md-nav__link">
    Les Services
  </a>
  
    <nav class="md-nav" aria-label="Les Services">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#clusterip" class="md-nav__link">
    ClusterIP
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nodeport" class="md-nav__link">
    NodePort
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#loadblancer" class="md-nav__link">
    Loadblancer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#k8s-snippets" class="md-nav__link">
    k8s snippets
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../yaml/" class="md-nav__link">
        YAML
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../redis/" class="md-nav__link">
        Redis
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../az_devops/" class="md-nav__link">
        AzDevOps pipelines
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../terraform/" class="md-nav__link">
        Terraform
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          AZ-104
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="AZ-104" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          AZ-104
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../az104/az-ad/" class="md-nav__link">
        Managing Azure Active Directory
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../az104/sub_and_gov/" class="md-nav__link">
        Subscription and Governance
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          Guidelines
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Guidelines" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Guidelines
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ide_vscode/conf/" class="md-nav__link">
        IDE vscode
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_2" type="checkbox" id="__nav_7_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_2">
          Documentation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Documentation" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_2">
          <span class="md-nav__icon md-icon"></span>
          Documentation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../doc_redaction/mkdocs/" class="md-nav__link">
        MkDocs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../doc_redaction/diagrammes/" class="md-nav__link">
        Diagrammes
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_3" type="checkbox" id="__nav_7_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_3">
          Formating, Linting, Type Hinting
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Formating, Linting, Type Hinting" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_3">
          <span class="md-nav__icon md-icon"></span>
          Formating, Linting, Type Hinting
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../format_lint_hint/format/" class="md-nav__link">
        Formating
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../format_lint_hint/lint/" class="md-nav__link">
        Linting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../format_lint_hint/hint/" class="md-nav__link">
        Hint
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_4" type="checkbox" id="__nav_7_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_4">
          Tests
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Tests" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_4">
          <span class="md-nav__icon md-icon"></span>
          Tests
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../testing/unittests/" class="md-nav__link">
        Test unitaire
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_5" type="checkbox" id="__nav_7_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_5">
          CI/CD
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="CI/CD" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_5">
          <span class="md-nav__icon md-icon"></span>
          CI/CD
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cicd/precommit/" class="md-nav__link">
        Pre-commit
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_6" type="checkbox" id="__nav_7_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_6">
          Code quality
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Code quality" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_6">
          <span class="md-nav__icon md-icon"></span>
          Code quality
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../code_quality/radon/" class="md-nav__link">
        Radon
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_7" type="checkbox" id="__nav_7_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_7">
          Code security
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Code security" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_7">
          <span class="md-nav__icon md-icon"></span>
          Code security
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../code_security/bandit/" class="md-nav__link">
        Bandit
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8">
          Lectures
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Lectures" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Lectures
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../lectures/gradient_centralization/" class="md-nav__link">
        Gradient Centralization
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table des matières">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table des matières
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#orchestration" class="md-nav__link">
    Orchestration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#architecture-kubernetes" class="md-nav__link">
    Architecture kubernetes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kubectl" class="md-nav__link">
    kubectl
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installer-kubernetes" class="md-nav__link">
    Installer kubernetes
  </a>
  
    <nav class="md-nav" aria-label="Installer kubernetes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    References
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#concept-de-base-les-pods" class="md-nav__link">
    Concept de base : les Pods
  </a>
  
    <nav class="md-nav" aria-label="Concept de base : les Pods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pod-multi-conteneur" class="md-nav__link">
    POD multi-conteneur
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#les-commandes-de-base" class="md-nav__link">
    Les commandes de base
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#concepts-pods-replicasets-deployments" class="md-nav__link">
    Concepts : PODs, ReplicaSets, Deployments
  </a>
  
    <nav class="md-nav" aria-label="Concepts : PODs, ReplicaSets, Deployments">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creer-un-pod-via-yaml" class="md-nav__link">
    Créer un pod via YAML
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#replications" class="md-nav__link">
    Réplications
  </a>
  
    <nav class="md-nav" aria-label="Réplications">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#replicaset-controleur-de-replications" class="md-nav__link">
    ReplicaSet, contrôleur de réplications
  </a>
  
    <nav class="md-nav" aria-label="ReplicaSet, contrôleur de réplications">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#replicationcontroller" class="md-nav__link">
    ReplicationController
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#replicaset" class="md-nav__link">
    ReplicaSet
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#augmenter-le-nombre-de-repliques" class="md-nav__link">
    Augmenter le nombre de répliques
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deployment" class="md-nav__link">
    Deployment
  </a>
  
    <nav class="md-nav" aria-label="Deployment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#updates-et-rollback" class="md-nav__link">
    Updates et Rollback
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#notion-de-reseaux-dans-kubernetes" class="md-nav__link">
    Notion de réseaux dans kubernetes
  </a>
  
    <nav class="md-nav" aria-label="Notion de réseaux dans kubernetes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cas-dun-noeud-unique" class="md-nav__link">
    Cas d'un noeud unique
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cas-de-plusieurs-noeuds" class="md-nav__link">
    Cas de plusieurs noeuds
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#les-services" class="md-nav__link">
    Les Services
  </a>
  
    <nav class="md-nav" aria-label="Les Services">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#clusterip" class="md-nav__link">
    ClusterIP
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nodeport" class="md-nav__link">
    NodePort
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#loadblancer" class="md-nav__link">
    Loadblancer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#k8s-snippets" class="md-nav__link">
    k8s snippets
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="kubernetes-for-the-beginner"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13.95 13.5h-.23c-.18.11-.26.32-.18.5l.86 2.11c.83-.53 1.46-1.32 1.79-2.25l-2.23-.36h-.01m-3.45.29a.415.415 0 0 0-.38-.29h-.08l-2.22.37c.33.92.96 1.7 1.79 2.23l.85-2.07V14c.04-.05.04-.14.04-.21m1.83.81a.378.378 0 0 0-.51-.15c-.07.05-.12.08-.15.15h-.01l-1.09 1.97c.78.26 1.62.31 2.43.12.14-.03.29-.07.43-.12l-1.09-1.97h-.01m3.45-4.57L14.1 11.5l.01.03a.37.37 0 0 0-.04.53c.05.06.11.1.18.12l.01.01 2.17.62c.07-.97-.14-1.95-.65-2.78m-3.11.16c.01.21.18.37.39.36.08 0 .15-.02.21-.05h.01l1.83-1.31a4.45 4.45 0 0 0-2.57-1.24l.13 2.24m-1.94.31c.17.11.4.08.52-.09.05-.06.07-.13.08-.21h.01l.12-2.25c-.15.02-.3.05-.46.08-.8.18-1.54.58-2.12 1.16l1.84 1.31h.01m-.99 1.69c.2-.05.32-.26.26-.46 0-.08-.05-.14-.11-.19v-.01L8.21 10c-.52.86-.74 1.84-.63 2.82l2.16-.62v-.01m1.64.66.62.3.62-.3.15-.67-.43-.53h-.69l-.43.53.16.67m10.89 1.32L20.5 6.5c-.09-.42-.37-.76-.74-.94l-7.17-3.43c-.37-.17-.81-.17-1.19 0L4.24 5.56c-.37.18-.65.52-.74.94l-1.77 7.67c-.05.2-.05.4 0 .59.01.06.03.12.05.18.03.09.08.19.13.27.03.04.05.08.09.11l4.95 6.18c.02 0 .05.04.05.06.1.09.19.16.28.22.12.08.26.14.4.17.11.05.23.05.32.05h8.12c.07 0 .14-.03.2-.05.05-.01.1-.03.14-.04.04-.02.07-.03.11-.05.05-.02.1-.05.15-.08.12-.08.23-.18.33-.28l.15-.2 4.8-5.98c.1-.12.17-.25.22-.38.02-.06.04-.12.05-.18.05-.19.05-.4 0-.59m-7.43 2.99c.02.06.04.12.07.17-.04.08-.06.17-.03.26.12.24.23.46.38.68.08.11.16.23.24.34 0 .03.03.08.04.12.12.2.06.46-.15.59s-.47.05-.59-.15c-.01-.03-.02-.05-.03-.08-.02-.03-.04-.09-.06-.09-.05-.15-.09-.28-.12-.41-.09-.25-.17-.49-.3-.72a.375.375 0 0 0-.21-.14l-.08-.16c-1.29.48-2.7.48-3.97-.01l-.1.18c-.07.01-.14.04-.19.09-.14.24-.24.49-.33.77-.03.13-.07.26-.12.4-.02 0-.04.07-.06.1a.43.43 0 0 1-.81-.29c.01-.03.03-.05.04-.08.04-.03.04-.08.04-.11.09-.12.16-.23.24-.35.16-.21.29-.45.39-.69a.54.54 0 0 0-.03-.25l.07-.18a5.611 5.611 0 0 1-2.47-3.09l-.2.03a.388.388 0 0 0-.23-.09c-.27.05-.51.13-.77.22-.11.06-.24.11-.37.15-.03.01-.07.02-.13.03a.438.438 0 0 1-.54-.27c-.07-.23.04-.47.28-.55.02 0 .05-.01.08-.01v-.01h.01l.11-.02c.14-.04.28-.04.41-.04.26 0 .52-.06.77-.12.08-.05.14-.11.19-.19l.19-.05c-.21-1.36.1-2.73.86-3.87l-.14-.12c0-.09-.03-.18-.08-.25-.2-.17-.41-.32-.64-.45-.12-.06-.24-.13-.36-.21-.02-.02-.06-.05-.08-.07l-.01-.01c-.2-.16-.25-.42-.11-.63.09-.1.21-.15.35-.15.11.01.21.05.3.12l.09.07c.1.09.19.2.28.3.18.19.37.37.58.52.08.04.17.05.26.03l.15.11c.75-.8 1.73-1.36 2.8-1.6.25-.06.52-.1.78-.12l.01-.18a.45.45 0 0 0 .14-.23c.01-.26-.01-.52-.05-.77-.03-.13-.05-.27-.06-.41V5.1c-.02-.24.15-.45.39-.48s.44.15.47.38v.22c-.01.14-.03.28-.06.41-.04.25-.06.51-.05.77.02.1.07.17.14.22l.01.19c1.36.12 2.62.73 3.56 1.72l.16-.12c.09.02.18.01.26-.03.21-.15.41-.33.58-.52.09-.1.18-.2.28-.3.03-.02.07-.06.1-.06.17-.18.44-.18.59 0 .19.16.18.43 0 .6 0 .02-.03.04-.06.06a2.495 2.495 0 0 1-.44.28c-.23.13-.45.28-.64.45-.06.07-.09.15-.08.24l-.16.14a5.44 5.44 0 0 1 .88 3.86l.19.05c.04.08.11.14.19.18.25.07.51.11.77.14h.41c.03.03.08.04.12.05.24.03.4.25.37.49-.05.23-.24.4-.48.37-.03-.01-.07-.01-.07-.02v-.01c-.06 0-.1-.01-.14-.02-.13-.04-.25-.09-.36-.15-.26-.1-.5-.17-.77-.21-.09 0-.17 0-.23.08-.07-.01-.13-.02-.19-.03-.41 1.31-1.31 2.41-2.47 3.11Z"/></svg></span> Kubernetes for the beginner</h1>
<p>Aussi dénommé k8s, kubernetes a été développé par Google, capitalisant sur leur expérience des conteneurs en production.</p>
<p>k8s est un système d'orchestration de conteneurs. Pour les conteneurs on se réfère à la section précédente, parlons de l'orchestration.</p>
<h2 id="orchestration">Orchestration</h2>
<p>Avec une commande <code>docker run</code>, on est capable de déployer une instance d'un conteneur, par exemple une api.</p>
<ul>
<li>Mais que se passe-t-il si le nombre de requêtes envoyées à cette api est trop important ? On pourrait déployer une seconde instance de cette api pour gérer le flux supplémentaire.</li>
<li>On pourrait le faire en relançant une commande <code>docker run</code>, mais cela demande de le faire de façon manuelle et de surveiller à chaque fois comment cela se passe.</li>
<li>De la même façon, un fois le pic de requête passé, on pourrait alors vouloir supprimer certaines instances, pour récupérer des ressources.</li>
<li>Si le conteneur crashe, on devrait pouvoir le détecter et relancer une image automatiquement.</li>
<li>Si le docker host crashe, tous les conteneurs lancés s'arrêteront aussi.</li>
</ul>
<p>Pour gérer ces problèmes dans un environnement de production, on fait alors appel à des systèmes <strong>d'orchestrations des conteneurs</strong> :</p>
<ul>
<li>docker-swarm,</li>
<li>kubernetes,</li>
<li>MESOS.</li>
</ul>
<p>On se concentre ici sur kubernetes.</p>
<p><strong>Les avantages d'un orchestrateur sont alors que vos applications sont facilement et toujours disponibles, un crash étant alors automatiquement détecté et une nouvelle instance lancée. Plusieurs instance d'une même application peuvent être lancées en même temps, ce qui permet d'équilibrer le traffic.</strong></p>
<h2 id="architecture-kubernetes">Architecture kubernetes</h2>
<p>Quand on parle de k8s, on d'un cluster kubernetes, de la même façon qu'on parlerait d'un cluster de cpu travaillant de façon conjointe.</p>
<p>L'atome d'un cluster k8s est un <strong>node</strong> (noeud), un noeud est une machine, qu'elle soit physique ou virtuelle, sur laquelle est installé k8s. C'est sur  un noeud que se lance les conteneurs que k8s orchestre. Evidemment, si l'on a qu'un seul noeud et qu'il crashe, k8s ne pourra rien faire et donc vos conteneurs ne seront plus accessibles. C'est là tout l'intérêt d'un cluster centralisant plusieurs noeuds.</p>
<p>Dans un cluster k8s, il y a toujours un noeud principal, le <strong>Master node</strong>, c'est sur lui que k8s est installé, et qui gère l'ensemble des noeuds du cluster qui sont des <strong>workers nodes</strong>. <strong>C'est le noeud principal qui est responsable de l'orchestration en tant que tel.</strong></p>
<p>Lorsque l'on installe kubernetes, on installe en fait une suite de composants :</p>
<ul>
<li>un serveur api,</li>
<li>un service <a href="https://etcd.io/"><code>etcd</code></a>,</li>
<li>un service <code>kubelet</code>,</li>
<li>un <code>container runtime</code>,</li>
<li>un controlleur,</li>
<li>un scheduler.</li>
</ul>
<p>L'api est l'interface principale avec laquelle l'utilisateur interagit, les lignes de commandes, le management des conteneurs, tout se fait via cette api.</p>
<p><code>etcd</code> est le système de stockage interne de kubernetes, il est par exemple responsable de la configuration des logs entre les différentes instances d'un même conteneur.</p>
<p>Le scheduler est celui qui distribue le travail, ou les conteneurs, aux différents noeuds du cluster. Il assigne les conteneurs nouvellments créés aux noeuds.</p>
<p>Le controlleur est le cerveau de l'orchestration, il est responsable de la surveillance des noeuds et des contneeurs qui crashent. C'est lui qui décide de recréer un nouveau conteneur si nécessaire.</p>
<p>Le <code>container runtime</code> est le software sous-jacent permettant de faire tourner les conteneurs, dans la plupart du temps, c'est <a href="https://containerd.io/">containerd</a>.</p>
<div class="admonition info">
<p class="admonition-title">Remarque</p>
<p>Il existe d'autres container runtime, on peut citer par exemple <a href="https://cri-o.io/">cri-o</a>.</p>
</div>
<p><code>kubelet</code> est l'agent qui tourne sur chaque noeud, et qui surveille que les conteneurs présents sur le noeud fonctionnent comme prévu.</p>
<h2 id="kubectl"><code>kubectl</code></h2>
<p><code>kubectl</code> est l'outil de ligne de commande principal pour interagir, déployer et manager avec kubernetes.</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">helloworld de kubernetes</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a>kubectl<span class="w"> </span>run<span class="w"> </span>hello-minikube
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Affiche les informations du cluster</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a>kubectl<span class="w"> </span>cluster-info
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">liste l'ensemble des noeuds du conteneur</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1"></a>kubectl<span class="w"> </span>get<span class="w"> </span>nodes
</code></pre></div></td></tr></table></div>
<h2 id="installer-kubernetes">Installer kubernetes</h2>
<p>Pour installer k8s sur sa propre machine, il est possible d'utiliser l'une des solutions suivantes.</p>
<ul>
<li>Minikube</li>
<li>k3s</li>
<li>MicroK8s</li>
<li>Kubeadm</li>
</ul>
<p>Dans tous les cas, on ne pourra avoir qu'un seul noeud, et il sera aussi nécessaire d'installer un software de machine virtuelle. Sur les systèmes Linux, l'outil de vistualisation installé de base est <a href="https://www.redhat.com/fr/topics/virtualization/what-is-KVM">KVM</a>.</p>
<p>Pour vérifier si KVM est correctement installé sur votre système, vous pouvez vérifier avec la commande <code>kvm-ok</code>.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1">1</a></span>
<span class="normal"><a href="#__codelineno-3-2">2</a></span>
<span class="normal"><a href="#__codelineno-3-3">3</a></span>
<span class="normal"><a href="#__codelineno-3-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a>❯<span class="w"> </span>kvm-ok
<a id="__codelineno-3-2" name="__codelineno-3-2"></a>
<a id="__codelineno-3-3" name="__codelineno-3-3"></a>INFO:<span class="w"> </span>/dev/kvm<span class="w"> </span>exists
<a id="__codelineno-3-4" name="__codelineno-3-4"></a>KVM<span class="w"> </span>acceleration<span class="w"> </span>can<span class="w"> </span>be<span class="w"> </span>used
</code></pre></div></td></tr></table></div>
<h3 id="references">References</h3>
<ul>
<li>
<p>Install and set up the kubectl tool: https://kubernetes.io/docs/tasks/tools/</p>
</li>
<li>
<p>Install Minikube: https://minikube.sigs.k8s.io/docs/start/ https://kubernetes.io/fr/docs/tasks/tools/install-minikube/</p>
</li>
<li>
<p>Install VirtualBox: https://www.virtualbox.org/wiki/Downloads https://www.virtualbox.org/wiki/Linux_Downloads</p>
</li>
<li>
<p>Minikube Tutorial: https://kubernetes.io/docs/tutorials/hello-minikube/</p>
</li>
</ul>
<h2 id="concept-de-base-les-pods">Concept de base : les Pods</h2>
<p>Avec k8s, le but ultime est de déployer une application sous la forme de conteneurs sur un ensemble de machines configurées comme des noeuds de travail sur un cluster.</p>
<pre class="mermaid"><code>graph LR

    subgraph cluster
        A[node]

        B[node]

        C[node]
    end</code></pre>
<p>Cependant, k8s ne déploie pas directement les conteneurs sur les noeuds de travail, <strong>les conteneurs sont encapsulés dans un objet k8s connu sous le nom de pod</strong>.</p>
<pre class="mermaid"><code>graph LR

    subgraph cluster
        subgraph node
            A[pod &lt;br/&gt; conteneur]
        end

        subgraph node
            B[pod &lt;br/&gt; conteneur]
        end

        subgraph node
            C[pod &lt;br/&gt; conteneur]
        end
    end</code></pre>
<p>Un pod est une instance d'une application. <strong>C'est le plus petit objet que l'on puisse créer dans k8s.</strong></p>
<div class="admonition example">
<p class="admonition-title">Exemple</p>
<p>Exemple de configuration la plus simple, un cluter avec un noeud unique, contenant un unique pod, faisant tourner un conteneur avec python 3.8 dessus.</p>
<pre class="mermaid"><code>graph LR

    subgraph cluster
        subgraph node
            A[pod &lt;br/&gt; conteneur python:3.8]
        end
    end</code></pre>
</div>
<pre class="mermaid"><code>graph LR

    subgraph cluster
        subgraph node
            A[pod &lt;br/&gt; conteneur python:3.8]
        end
    end

B[User1] &amp; C[User2] &amp; D[User3] &amp; E[User4] -.-&gt; A</code></pre>
<p>Si beaucoup d'utilisateurs se connectent au pod et que l'on souhaite équilibrer la charge, la solution retenue par k8s est alors de lancer un nouveau pod avec le même conteneur sur le même noeud.</p>
<pre class="mermaid"><code>graph LR

    subgraph cluster
        subgraph node
            A1[pod 1&lt;br/&gt; conteneur python:3.8]
            A2[pod 2&lt;br/&gt; conteneur python:3.8]
        end
    end

B[User1] &amp; C[User2] -.-&gt; A1
D[User3] &amp; E[User4] -.-&gt; A2</code></pre>
<p>Et si le nombre d'utilisateur augmente encore et que le noeud n'a plus la capacité d'acceuillir un pod supplémentaire ? Il est toujours possible de rajouter un nouveau noeud avec un nouveau pod contenant le conteneur.</p>
<pre class="mermaid"><code>graph LR

    subgraph cluster
        subgraph node 1
            A1[pod 1&lt;br/&gt; conteneur python:3.8]
            A2[pod 2&lt;br/&gt; conteneur python:3.8]
        end
        subgraph node 2
            A3[pod 3&lt;br/&gt; conteneur python:3.8]
        end
    end

B[User1] &amp; C[User2] -.-&gt; A1
D[User3] &amp; E[User4] -.-&gt; A2
F[User5] &amp; G[User6] -.-&gt; A3</code></pre>
<p><strong>La plupart du temps, les pods sont en correspondance bijective avec les conteneurs faisant tourner les applications</strong>. En d'autres termes, un pod = un conteneur. Pour augmenter la charge on augmente le nombre de pods, pour la baisser on en supprime.</p>
<h3 id="pod-multi-conteneur">POD multi-conteneur</h3>
<p>La correspondance pod/conteneur n'est pas une règle stricte et un pod peut très bien faire tourner plusieurs conteneurs. Dans la plupart des cas ces conteneurs ne sont pas identiques. On peut par exemple imaginer un pod contenant une API REST et son UI correspondante, avec les connexions reliant les deux comme le ferait docker compose. Les conteneurs à l'intéreur d'un même pod partage le même namespace, storage space, réseau, etc.</p>
<h3 id="les-commandes-de-base">Les commandes de base</h3>
<p>l'API utilisé pour gérer les cluster k8s est <code>kubectl</code>.</p>
<table>
<thead>
<tr>
<th align="center">Commande</th>
<th align="center">Résultat</th>
<th align="center">Exemple</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><code>kubectl run podname --image image_path</code></td>
<td align="center">lance un pod nommé <code>podname</code> contenant l'image se trouvant à l'adresse (cr) <code>image_path</code>.</td>
<td align="center"><code>kubectl run helloworld-api --image vorphus/helloworld-api:1.0</code></td>
</tr>
<tr>
<td align="center"><code>kubectl get pods</code></td>
<td align="center">Liste l'ensemble des pods.</td>
<td align="center"></td>
</tr>
<tr>
<td align="center"><code>kubectl get pods -o wide</code></td>
<td align="center">Liste l'ensemble des pods avec plus d'informations.</td>
<td align="center"></td>
</tr>
<tr>
<td align="center"><code>kubectl describe pod podname</code></td>
<td align="center">Affiche des informations concernant le pod <code>podname</code>.</td>
<td align="center"><code>kubectl describe pod helloworld-api</code></td>
</tr>
<tr>
<td align="center"><code>kubectl delete pod podname</code></td>
<td align="center">Supprime le pod <code>podname</code>.</td>
<td align="center"><code>kubectl delete pod helloworld-api</code></td>
</tr>
</tbody>
</table>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">kubectl describe pod helloworld-api</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-4-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-4-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-4-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-4-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-4-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-4-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-4-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-4-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-4-10">10</a></span>
<span class="normal"><a href="#__codelineno-4-11">11</a></span>
<span class="normal"><a href="#__codelineno-4-12">12</a></span>
<span class="normal"><a href="#__codelineno-4-13">13</a></span>
<span class="normal"><a href="#__codelineno-4-14">14</a></span>
<span class="normal"><a href="#__codelineno-4-15">15</a></span>
<span class="normal"><a href="#__codelineno-4-16">16</a></span>
<span class="normal"><a href="#__codelineno-4-17">17</a></span>
<span class="normal"><a href="#__codelineno-4-18">18</a></span>
<span class="normal"><a href="#__codelineno-4-19">19</a></span>
<span class="normal"><a href="#__codelineno-4-20">20</a></span>
<span class="normal"><a href="#__codelineno-4-21">21</a></span>
<span class="normal"><a href="#__codelineno-4-22">22</a></span>
<span class="normal"><a href="#__codelineno-4-23">23</a></span>
<span class="normal"><a href="#__codelineno-4-24">24</a></span>
<span class="normal"><a href="#__codelineno-4-25">25</a></span>
<span class="normal"><a href="#__codelineno-4-26">26</a></span>
<span class="normal"><a href="#__codelineno-4-27">27</a></span>
<span class="normal"><a href="#__codelineno-4-28">28</a></span>
<span class="normal"><a href="#__codelineno-4-29">29</a></span>
<span class="normal"><a href="#__codelineno-4-30">30</a></span>
<span class="normal"><a href="#__codelineno-4-31">31</a></span>
<span class="normal"><a href="#__codelineno-4-32">32</a></span>
<span class="normal"><a href="#__codelineno-4-33">33</a></span>
<span class="normal"><a href="#__codelineno-4-34">34</a></span>
<span class="normal"><a href="#__codelineno-4-35">35</a></span>
<span class="normal"><a href="#__codelineno-4-36">36</a></span>
<span class="normal"><a href="#__codelineno-4-37">37</a></span>
<span class="normal"><a href="#__codelineno-4-38">38</a></span>
<span class="normal"><a href="#__codelineno-4-39">39</a></span>
<span class="normal"><a href="#__codelineno-4-40">40</a></span>
<span class="normal"><a href="#__codelineno-4-41">41</a></span>
<span class="normal"><a href="#__codelineno-4-42">42</a></span>
<span class="normal"><a href="#__codelineno-4-43">43</a></span>
<span class="normal"><a href="#__codelineno-4-44">44</a></span>
<span class="normal"><a href="#__codelineno-4-45">45</a></span>
<span class="normal"><a href="#__codelineno-4-46">46</a></span>
<span class="normal"><a href="#__codelineno-4-47">47</a></span>
<span class="normal"><a href="#__codelineno-4-48">48</a></span>
<span class="normal"><a href="#__codelineno-4-49">49</a></span>
<span class="normal"><a href="#__codelineno-4-50">50</a></span>
<span class="normal"><a href="#__codelineno-4-51">51</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a>❯ kubectl describe pod helloworld-api
<a id="__codelineno-4-2" name="__codelineno-4-2"></a>
<a id="__codelineno-4-3" name="__codelineno-4-3"></a>Name:         helloworld-api
<a id="__codelineno-4-4" name="__codelineno-4-4"></a>Namespace:    default
<a id="__codelineno-4-5" name="__codelineno-4-5"></a>Priority:     0
<a id="__codelineno-4-6" name="__codelineno-4-6"></a>Node:         minikube/192.168.39.66
<a id="__codelineno-4-7" name="__codelineno-4-7"></a>Start Time:   Thu, 07 Jul 2022 22:22:47 +0200
<a id="__codelineno-4-8" name="__codelineno-4-8"></a>Labels:       run=helloworld-api
<a id="__codelineno-4-9" name="__codelineno-4-9"></a>Annotations:  &lt;none&gt;
<a id="__codelineno-4-10" name="__codelineno-4-10"></a>Status:       Running
<a id="__codelineno-4-11" name="__codelineno-4-11"></a>IP:           172.17.0.3
<a id="__codelineno-4-12" name="__codelineno-4-12"></a>IPs:
<a id="__codelineno-4-13" name="__codelineno-4-13"></a>  IP:  172.17.0.3
<a id="__codelineno-4-14" name="__codelineno-4-14"></a>Containers:
<a id="__codelineno-4-15" name="__codelineno-4-15"></a>  helloworld-api:
<a id="__codelineno-4-16" name="__codelineno-4-16"></a>    Container ID:   docker://1bb8c1064c829172282c0e13fc08ef22b24755077f161352ff5a7cee240b3cf1
<a id="__codelineno-4-17" name="__codelineno-4-17"></a>    Image:          vorphus/helloworld-api:1.0
<a id="__codelineno-4-18" name="__codelineno-4-18"></a>    Image ID:       docker-pullable://vorphus/helloworld-api@sha256:e8d49d5c9fc1924f1702d7b4bc3a28bb42c639fc9f87c6c2031a45859ca2d463
<a id="__codelineno-4-19" name="__codelineno-4-19"></a>    Port:           &lt;none&gt;
<a id="__codelineno-4-20" name="__codelineno-4-20"></a>    Host Port:      &lt;none&gt;
<a id="__codelineno-4-21" name="__codelineno-4-21"></a>    State:          Running
<a id="__codelineno-4-22" name="__codelineno-4-22"></a>      Started:      Thu, 07 Jul 2022 22:22:48 +0200
<a id="__codelineno-4-23" name="__codelineno-4-23"></a>    Ready:          True
<a id="__codelineno-4-24" name="__codelineno-4-24"></a>    Restart Count:  0
<a id="__codelineno-4-25" name="__codelineno-4-25"></a>    Environment:    &lt;none&gt;
<a id="__codelineno-4-26" name="__codelineno-4-26"></a>    Mounts:
<a id="__codelineno-4-27" name="__codelineno-4-27"></a>      /var/run/secrets/kubernetes.io/serviceaccount from kube-api-access-wmjdf (ro)
<a id="__codelineno-4-28" name="__codelineno-4-28"></a>Conditions:
<a id="__codelineno-4-29" name="__codelineno-4-29"></a>  Type              Status
<a id="__codelineno-4-30" name="__codelineno-4-30"></a>  Initialized       True
<a id="__codelineno-4-31" name="__codelineno-4-31"></a>  Ready             True
<a id="__codelineno-4-32" name="__codelineno-4-32"></a>  ContainersReady   True
<a id="__codelineno-4-33" name="__codelineno-4-33"></a>  PodScheduled      True
<a id="__codelineno-4-34" name="__codelineno-4-34"></a>Volumes:
<a id="__codelineno-4-35" name="__codelineno-4-35"></a>  kube-api-access-wmjdf:
<a id="__codelineno-4-36" name="__codelineno-4-36"></a>    Type:                    Projected (a volume that contains injected data from multiple sources)
<a id="__codelineno-4-37" name="__codelineno-4-37"></a>    TokenExpirationSeconds:  3607
<a id="__codelineno-4-38" name="__codelineno-4-38"></a>    ConfigMapName:           kube-root-ca.crt
<a id="__codelineno-4-39" name="__codelineno-4-39"></a>    ConfigMapOptional:       &lt;nil&gt;
<a id="__codelineno-4-40" name="__codelineno-4-40"></a>    DownwardAPI:             true
<a id="__codelineno-4-41" name="__codelineno-4-41"></a>QoS Class:                   BestEffort
<a id="__codelineno-4-42" name="__codelineno-4-42"></a>Node-Selectors:              &lt;none&gt;
<a id="__codelineno-4-43" name="__codelineno-4-43"></a>Tolerations:                 node.kubernetes.io/not-ready:NoExecute op=Exists for 300s
<a id="__codelineno-4-44" name="__codelineno-4-44"></a>                             node.kubernetes.io/unreachable:NoExecute op=Exists for 300s
<a id="__codelineno-4-45" name="__codelineno-4-45"></a>Events:
<a id="__codelineno-4-46" name="__codelineno-4-46"></a>  Type    Reason     Age   From               Message
<a id="__codelineno-4-47" name="__codelineno-4-47"></a>  ----    ------     ----  ----               -------
<a id="__codelineno-4-48" name="__codelineno-4-48"></a>  Normal  Scheduled  17m   default-scheduler  Successfully assigned default/helloworld-api to minikube
<a id="__codelineno-4-49" name="__codelineno-4-49"></a>  Normal  Pulled     17m   kubelet            Container image &quot;vorphus/helloworld-api:1.0&quot; already present on machine
<a id="__codelineno-4-50" name="__codelineno-4-50"></a>  Normal  Created    17m   kubelet            Created container helloworld-api
<a id="__codelineno-4-51" name="__codelineno-4-51"></a>  Normal  Started    17m   kubelet            Started container helloworld-api
</code></pre></div></td></tr></table></div>
<p>Pour créer un déploiement utilisant la méthode impérative, on utilise la commande <code>kubectl create</code>.</p>
<p><code>kubectl create deployment nginx --image=nginx</code></p>
<ul>
<li>
<p>Kubernetes Concepts – https://kubernetes.io/docs/concepts/</p>
</li>
<li>
<p>Pod Overview- https://kubernetes.io/docs/concepts/workloads/pods/pod-overview/</p>
</li>
</ul>
<h2 id="concepts-pods-replicasets-deployments">Concepts : PODs, ReplicaSets, Deployments</h2>
<h3 id="creer-un-pod-via-yaml">Créer un pod via YAML</h3>
<p>k8s utilise la synthaxe YAML pour créer ses objets. Tous les fichiers utilisés par k8s suivent la même structure.</p>
<p>Il y a 4 entrée de niveau maximal (root), et ces entrées sont <strong>nécessaires</strong> dans un fichier yml pour k8s.</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">pod-definition.yml</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-5-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-5-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-5-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-5-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-5-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-5-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-5-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-5-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-5-10">10</a></span>
<span class="normal"><a href="#__codelineno-5-11">11</a></span>
<span class="normal"><a href="#__codelineno-5-12">12</a></span>
<span class="normal"><a href="#__codelineno-5-13">13</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="nn">---</span>
<a id="__codelineno-5-2" name="__codelineno-5-2"></a><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<a id="__codelineno-5-3" name="__codelineno-5-3"></a><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Pod</span>
<a id="__codelineno-5-4" name="__codelineno-5-4"></a><span class="nt">metadata</span><span class="p">:</span>
<a id="__codelineno-5-5" name="__codelineno-5-5"></a><span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp-pod</span>
<a id="__codelineno-5-6" name="__codelineno-5-6"></a><span class="w">    </span><span class="nt">labels</span><span class="p">:</span>
<a id="__codelineno-5-7" name="__codelineno-5-7"></a><span class="w">        </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-app</span>
<a id="__codelineno-5-8" name="__codelineno-5-8"></a><span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">front-end</span>
<a id="__codelineno-5-9" name="__codelineno-5-9"></a>
<a id="__codelineno-5-10" name="__codelineno-5-10"></a><span class="nt">spec</span><span class="p">:</span>
<a id="__codelineno-5-11" name="__codelineno-5-11"></a><span class="w">    </span><span class="nt">containers</span><span class="p">:</span>
<a id="__codelineno-5-12" name="__codelineno-5-12"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx-container</span>
<a id="__codelineno-5-13" name="__codelineno-5-13"></a><span class="w">          </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>
<p><code>apiVersion</code> correspond à la version de l'api k8s utilisée pour créer les objets. En fonction de ce que l'on souhaite créer, il faut utiliser la bonne version. <strong>Pour créer des pods, on utilise la version <code>v1</code>.</strong></p>
</li>
<li>
<p><code>kind</code> correspond au type d'objet que l'on essaye de créer. On a la correspondance suivante entre <code>apiVersion</code> et <code>kind</code>.</p>
</li>
</ul>
<table>
<thead>
<tr>
<th align="center">kind</th>
<th align="center">apiVersion</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">POD</td>
<td align="center">v1</td>
</tr>
<tr>
<td align="center">Service</td>
<td align="center">v1</td>
</tr>
<tr>
<td align="center">ReplicaSet</td>
<td align="center">apps/v1</td>
</tr>
<tr>
<td align="center">Deployment</td>
<td align="center">apps/v1</td>
</tr>
</tbody>
</table>
<ul>
<li><code>metadata</code> correspond aux données qui sont rattachées à l'objet lui même, comme son nom, ses labels, etc. Par définition, <code>metadata</code> <strong>attend comme valeur un dictionnaire</strong> <code>yml</code>, <strong>alors que</strong> <code>apiVersion</code> <strong>et</strong> <code>kind</code> <strong>attendent un</strong> <code>string</code> comme valeur.</li>
</ul>
<div class="admonition info">
<p class="admonition-title">Remarque</p>
<p>Les jeux clé/valeur sous la clé <code>labels</code> <strong>sont complètement libre et à la discrétion de l'administrateur</strong>, ces labels servent à créer des tags pour filtrer les pods.</p>
</div>
<ul>
<li><code>spec</code> contient les spécifications techniques de l'objet que l'on crée, ici comme on crée un pod, on s'attend aux spécifications du ou des conteneurs adjoints au pod. <strong>Comme un pod peut contenir plusieurs conteneurs, on s'attend à une liste sous la clé</strong> <code>containers</code>.</li>
</ul>
<p>Pour créer le pod à partir de ce fichier de configuration, on utilise a commande suivante.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1"></a>kubectl<span class="w"> </span>create<span class="w"> </span>-f<span class="w"> </span>pod-definition.yml
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1"></a>kubectl<span class="w"> </span>get<span class="w"> </span>pods
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-8-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1"></a>kubectl<span class="w"> </span>describe<span class="w"> </span>pod<span class="w"> </span>my-app-pod
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-9-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1"></a>kubectl<span class="w"> </span>run<span class="w"> </span>redis<span class="w"> </span>--image<span class="o">=</span>redis<span class="w"> </span>--dry-run<span class="o">=</span>client<span class="w"> </span>-o<span class="w"> </span>yaml<span class="w"> </span>&gt;<span class="w"> </span>redis-definition.yaml
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">redis-definition.yml</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-10-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-10-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-10-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-10-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-10-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-10-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-10-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-10-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-10-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-10-10">10</a></span>
<span class="normal"><a href="#__codelineno-10-11">11</a></span>
<span class="normal"><a href="#__codelineno-10-12">12</a></span>
<span class="normal"><a href="#__codelineno-10-13">13</a></span>
<span class="normal"><a href="#__codelineno-10-14">14</a></span>
<span class="normal"><a href="#__codelineno-10-15">15</a></span>
<span class="normal"><a href="#__codelineno-10-16">16</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1"></a><span class="nn">---</span>
<a id="__codelineno-10-2" name="__codelineno-10-2"></a><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<a id="__codelineno-10-3" name="__codelineno-10-3"></a><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Pod</span>
<a id="__codelineno-10-4" name="__codelineno-10-4"></a><span class="nt">metadata</span><span class="p">:</span>
<a id="__codelineno-10-5" name="__codelineno-10-5"></a><span class="w">    </span><span class="nt">creationTimestamp</span><span class="p">:</span>
<a id="__codelineno-10-6" name="__codelineno-10-6"></a><span class="w">    </span><span class="nt">labels</span><span class="p">:</span>
<a id="__codelineno-10-7" name="__codelineno-10-7"></a><span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redis</span>
<a id="__codelineno-10-8" name="__codelineno-10-8"></a><span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redis</span>
<a id="__codelineno-10-9" name="__codelineno-10-9"></a><span class="nt">spec</span><span class="p">:</span>
<a id="__codelineno-10-10" name="__codelineno-10-10"></a><span class="w">    </span><span class="nt">containers</span><span class="p">:</span>
<a id="__codelineno-10-11" name="__codelineno-10-11"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redis</span>
<a id="__codelineno-10-12" name="__codelineno-10-12"></a><span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redis</span>
<a id="__codelineno-10-13" name="__codelineno-10-13"></a><span class="w">          </span><span class="nt">resources</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<a id="__codelineno-10-14" name="__codelineno-10-14"></a><span class="w">    </span><span class="nt">dnsPolicy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ClusterFirst</span>
<a id="__codelineno-10-15" name="__codelineno-10-15"></a><span class="w">    </span><span class="nt">restartPolicy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Always</span>
<a id="__codelineno-10-16" name="__codelineno-10-16"></a><span class="nt">status</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-11-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1"></a>kubectl create -f redis-definition.yaml
</code></pre></div></td></tr></table></div>
<p>Pour mettre à jour l'image d'un pod définie via la méthode impérative, on peut utiliser la commande <code>kubectl edit</code>.</p>
<p><code>kubectl edit pod redis</code></p>
<p>Si l'on a utilisé un fichier yaml, puis qu'on l'a édité via Vim, Nano, ou autre, pour mettre à jour le pod on utilise la commande <code>kubectl apply</code>.</p>
<p><code>kubectl apply -f redis-definition.yaml</code></p>
<h3 id="replications">Réplications</h3>
<p>Les contrôleurs sont les systèmes sous jacents qui gèrent les objets de kubernetes. En particulier les réplications.</p>
<p>Si l'on reprend notre cas d'usage très basique d'un unique conteneur dans un unique pod, alors si le pod crashe l'utilisateur n'a plus aucun accès  et perd toutes les informations.</p>
<pre class="mermaid"><code>graph LR

    subgraph cluster
        subgraph node
            A[pod &lt;br/&gt; conteneur python:3.8]
        end
    end</code></pre>
<p>Le contrôleur de réplication permet de gérer cela, c'est lui qui se charge de faire tourner plusieurs instances d'un même pod pour éviter les coupûres de service.</p>
<pre class="mermaid"><code>graph LR
    subgraph node
        subgraph "replication controller"
                A1[pod &lt;br/&gt; conteneur python:3.8]

                A2[pod &lt;br/&gt; conteneur python:3.8]
        end
    end</code></pre>
<p>Notez que le contrôleur de réplications se place au niveau du noeud, et pas du cluster. Le contrôleur s'assure que le nombre de pods spécifiés est présent tout le temps, même si ce nombre est 1.</p>
<p>Le contrôleur s'occupe aussi du load balancing et du scaling des pods via les différents noeuds du cluster.</p>
<h4 id="replicaset-controleur-de-replications">ReplicaSet, contrôleur de réplications</h4>
<p>Pour créer et gérer des réplications, il y a deux méthodes dans k8s :</p>
<ul>
<li>Définir un <code>ReplicationController</code>.</li>
<li>Définir un <code>ReplicaSet</code>.</li>
</ul>
<p><code>ReplicaSet</code> est la façon la plus moderne de définir des réplications dans k8s, mais les deux sont valides et sont sensiblement similaires dans leur écriture.</p>
<h5 id="replicationcontroller"><code>ReplicationController</code></h5>
<p>Pour définir un <code>ReplicationController</code>, on utilise la méthode suivante.</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">rc-definition.yml</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-12-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-12-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-12-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-12-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-12-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-12-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-12-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-12-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-12-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-12-10">10</a></span>
<span class="normal"><a href="#__codelineno-12-11">11</a></span>
<span class="normal"><a href="#__codelineno-12-12">12</a></span>
<span class="normal"><a href="#__codelineno-12-13">13</a></span>
<span class="normal"><a href="#__codelineno-12-14">14</a></span>
<span class="normal"><a href="#__codelineno-12-15">15</a></span>
<span class="normal"><a href="#__codelineno-12-16">16</a></span>
<span class="normal"><a href="#__codelineno-12-17">17</a></span>
<span class="normal"><a href="#__codelineno-12-18">18</a></span>
<span class="normal"><a href="#__codelineno-12-19">19</a></span>
<span class="normal"><a href="#__codelineno-12-20">20</a></span>
<span class="normal"><a href="#__codelineno-12-21">21</a></span>
<span class="normal"><a href="#__codelineno-12-22">22</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1"></a><span class="nn">---</span>
<a id="__codelineno-12-2" name="__codelineno-12-2"></a><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<a id="__codelineno-12-3" name="__codelineno-12-3"></a><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ReplicationController</span>
<a id="__codelineno-12-4" name="__codelineno-12-4"></a><span class="nt">metadata</span><span class="p">:</span>
<a id="__codelineno-12-5" name="__codelineno-12-5"></a><span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp-rc</span>
<a id="__codelineno-12-6" name="__codelineno-12-6"></a><span class="w">    </span><span class="nt">labels</span><span class="p">:</span>
<a id="__codelineno-12-7" name="__codelineno-12-7"></a><span class="w">        </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp</span>
<a id="__codelineno-12-8" name="__codelineno-12-8"></a><span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">front-end</span>
<a id="__codelineno-12-9" name="__codelineno-12-9"></a>
<a id="__codelineno-12-10" name="__codelineno-12-10"></a><span class="nt">spec</span><span class="p">:</span>
<a id="__codelineno-12-11" name="__codelineno-12-11"></a><span class="w">    </span><span class="nt">template</span><span class="p">:</span>
<a id="__codelineno-12-12" name="__codelineno-12-12"></a><span class="w">        </span><span class="nt">metadata</span><span class="p">:</span>
<a id="__codelineno-12-13" name="__codelineno-12-13"></a><span class="w">            </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp-pod</span>
<a id="__codelineno-12-14" name="__codelineno-12-14"></a><span class="w">            </span><span class="nt">labels</span><span class="p">:</span>
<a id="__codelineno-12-15" name="__codelineno-12-15"></a><span class="w">                </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp</span>
<a id="__codelineno-12-16" name="__codelineno-12-16"></a><span class="w">                </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">front-end</span>
<a id="__codelineno-12-17" name="__codelineno-12-17"></a><span class="w">        </span><span class="nt">spec</span><span class="p">:</span>
<a id="__codelineno-12-18" name="__codelineno-12-18"></a><span class="w">            </span><span class="nt">containers</span><span class="p">:</span>
<a id="__codelineno-12-19" name="__codelineno-12-19"></a><span class="w">                </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx-container</span>
<a id="__codelineno-12-20" name="__codelineno-12-20"></a><span class="w">                  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx</span>
<a id="__codelineno-12-21" name="__codelineno-12-21"></a>
<a id="__codelineno-12-22" name="__codelineno-12-22"></a><span class="w">    </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
</code></pre></div></td></tr></table></div>
<p>La première partie :</p>
<p><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-13-1">1</a></span>
<span class="normal"><a href="#__codelineno-13-2">2</a></span>
<span class="normal"><a href="#__codelineno-13-3">3</a></span>
<span class="normal"><a href="#__codelineno-13-4">4</a></span>
<span class="normal"><a href="#__codelineno-13-5">5</a></span>
<span class="normal"><a href="#__codelineno-13-6">6</a></span>
<span class="normal"><a href="#__codelineno-13-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1"></a><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<a id="__codelineno-13-2" name="__codelineno-13-2"></a><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ReplicationController</span>
<a id="__codelineno-13-3" name="__codelineno-13-3"></a><span class="nt">metadata</span><span class="p">:</span>
<a id="__codelineno-13-4" name="__codelineno-13-4"></a><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp-rc</span>
<a id="__codelineno-13-5" name="__codelineno-13-5"></a><span class="w">  </span><span class="nt">labels</span><span class="p">:</span>
<a id="__codelineno-13-6" name="__codelineno-13-6"></a><span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp</span>
<a id="__codelineno-13-7" name="__codelineno-13-7"></a><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">front-end</span>
</code></pre></div></td></tr></table></div>
est identique à celle définie dans la rédaction d'un pod : <code>Pod</code> et <code>ReplicationController</code> utilise la même version de l'api et les <code>metadata</code> ont la même signification dans les deux cas.</p>
<p>La deuxième partie elle est spécifique au choix <code>ReplicationController</code>. La partie <code>spec</code> définit quel type d'objet le <code>ReplicationController</code> doit générer. Pour cela il a besoin :</p>
<ol>
<li>du <code>template</code> de l'objet qu'il va générer</li>
<li>du nombre de répliques qu'il doit générer (<code>replicas</code>).</li>
</ol>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-14-1">1</a></span>
<span class="normal"><a href="#__codelineno-14-2">2</a></span>
<span class="normal"><a href="#__codelineno-14-3">3</a></span>
<span class="normal"><a href="#__codelineno-14-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1"></a><span class="nt">spec</span><span class="p">:</span>
<a id="__codelineno-14-2" name="__codelineno-14-2"></a><span class="w">  </span><span class="nt">template</span><span class="p">:</span>
<a id="__codelineno-14-3" name="__codelineno-14-3"></a>
<a id="__codelineno-14-4" name="__codelineno-14-4"></a><span class="w">  </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">n</span>
</code></pre></div></td></tr></table></div>
<p>Dans notre cas, l'objet que l'on souhaite gérer avec le <code>ReplicationController</code> étant un <code>Pod</code>, la partie <code>template</code> devra donc contenir les <code>spec</code> caractéristiques d'un pod.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-15-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-15-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-15-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-15-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-15-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-15-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-15-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-15-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-15-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-15-10">10</a></span>
<span class="normal"><a href="#__codelineno-15-11">11</a></span>
<span class="normal"><a href="#__codelineno-15-12">12</a></span>
<span class="normal"><a href="#__codelineno-15-13">13</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1"></a><span class="nt">spec</span><span class="p">:</span>
<a id="__codelineno-15-2" name="__codelineno-15-2"></a><span class="w">  </span><span class="nt">template</span><span class="p">:</span>
<a id="__codelineno-15-3" name="__codelineno-15-3"></a><span class="w">    </span><span class="nt">metadata</span><span class="p">:</span>
<a id="__codelineno-15-4" name="__codelineno-15-4"></a><span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp-pod</span>
<a id="__codelineno-15-5" name="__codelineno-15-5"></a><span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<a id="__codelineno-15-6" name="__codelineno-15-6"></a><span class="w">        </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp</span>
<a id="__codelineno-15-7" name="__codelineno-15-7"></a><span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">front-end</span>
<a id="__codelineno-15-8" name="__codelineno-15-8"></a><span class="w">    </span><span class="nt">spec</span><span class="p">:</span>
<a id="__codelineno-15-9" name="__codelineno-15-9"></a><span class="w">      </span><span class="nt">containers</span><span class="p">:</span>
<a id="__codelineno-15-10" name="__codelineno-15-10"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx-container</span>
<a id="__codelineno-15-11" name="__codelineno-15-11"></a><span class="w">          </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx</span>
<a id="__codelineno-15-12" name="__codelineno-15-12"></a>
<a id="__codelineno-15-13" name="__codelineno-15-13"></a><span class="w">  </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
</code></pre></div></td></tr></table></div>
<p>Remarquez que la partie</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-16-1">1</a></span>
<span class="normal"><a href="#__codelineno-16-2">2</a></span>
<span class="normal"><a href="#__codelineno-16-3">3</a></span>
<span class="normal"><a href="#__codelineno-16-4">4</a></span>
<span class="normal"><a href="#__codelineno-16-5">5</a></span>
<span class="normal"><a href="#__codelineno-16-6">6</a></span>
<span class="normal"><a href="#__codelineno-16-7">7</a></span>
<span class="normal"><a href="#__codelineno-16-8">8</a></span>
<span class="normal"><a href="#__codelineno-16-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1"></a><span class="w">    </span><span class="nt">metadata</span><span class="p">:</span>
<a id="__codelineno-16-2" name="__codelineno-16-2"></a><span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp-pod</span>
<a id="__codelineno-16-3" name="__codelineno-16-3"></a><span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<a id="__codelineno-16-4" name="__codelineno-16-4"></a><span class="w">        </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp</span>
<a id="__codelineno-16-5" name="__codelineno-16-5"></a><span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">front-end</span>
<a id="__codelineno-16-6" name="__codelineno-16-6"></a><span class="w">    </span><span class="nt">spec</span><span class="p">:</span>
<a id="__codelineno-16-7" name="__codelineno-16-7"></a><span class="w">      </span><span class="nt">containers</span><span class="p">:</span>
<a id="__codelineno-16-8" name="__codelineno-16-8"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx-container</span>
<a id="__codelineno-16-9" name="__codelineno-16-9"></a><span class="w">          </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx</span>
</code></pre></div></td></tr></table></div>
<p>est exactement celle qui est définie, en dehors de <code>apiVersion</code> et <code>kind</code>, dans un fichier yaml pour créer un pod.</p>
<p>Si l'on veut créer 3 répliques, on spécifit dans la partie <code>replicas</code> le nombre 3.</p>
<p>On peut alors le créer avec la commande suivante.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-17-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1"></a>kubectl<span class="w"> </span>create<span class="w"> </span>-f<span class="w"> </span>rc-definition.yml
</code></pre></div></td></tr></table></div>
<p>Pour voir l'objet <code>ReplicationController</code> on tape la commande suivante.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-18-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1"></a>kubectl<span class="w"> </span>get<span class="w"> </span>replicationcontroller
</code></pre></div></td></tr></table></div>
<p>On peut bien sur voir les pods créés avec la commande suivante.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-19-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1"></a>kubectl<span class="w"> </span>get<span class="w"> </span>pods
</code></pre></div></td></tr></table></div>
<p>Enfin, pour le détruire, on utilise la commande suivante.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-20-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1"></a>kubectl<span class="w"> </span>delete<span class="w"> </span>replicationcontroller<span class="w"> </span>myapp-rc
</code></pre></div></td></tr></table></div>
<h5 id="replicaset"><code>ReplicaSet</code></h5>
<p>Pour définir un <code>ReplicaSet</code>, on utilise la méthode suivante.</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">replicaset-definition.yml</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-21-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-21-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-21-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-21-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-21-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-21-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-21-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-21-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-21-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-21-10">10</a></span>
<span class="normal"><a href="#__codelineno-21-11">11</a></span>
<span class="normal"><a href="#__codelineno-21-12">12</a></span>
<span class="normal"><a href="#__codelineno-21-13">13</a></span>
<span class="normal"><a href="#__codelineno-21-14">14</a></span>
<span class="normal"><a href="#__codelineno-21-15">15</a></span>
<span class="normal"><a href="#__codelineno-21-16">16</a></span>
<span class="normal"><a href="#__codelineno-21-17">17</a></span>
<span class="normal"><a href="#__codelineno-21-18">18</a></span>
<span class="normal"><a href="#__codelineno-21-19">19</a></span>
<span class="normal"><a href="#__codelineno-21-20">20</a></span>
<span class="normal"><a href="#__codelineno-21-21">21</a></span>
<span class="normal"><a href="#__codelineno-21-22">22</a></span>
<span class="normal"><a href="#__codelineno-21-23">23</a></span>
<span class="normal"><a href="#__codelineno-21-24">24</a></span>
<span class="normal"><a href="#__codelineno-21-25">25</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1"></a><span class="nn">---</span>
<a id="__codelineno-21-2" name="__codelineno-21-2"></a><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apps/v1</span>
<a id="__codelineno-21-3" name="__codelineno-21-3"></a><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ReplicaSet</span>
<a id="__codelineno-21-4" name="__codelineno-21-4"></a><span class="nt">metadata</span><span class="p">:</span>
<a id="__codelineno-21-5" name="__codelineno-21-5"></a><span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp-replicaset</span>
<a id="__codelineno-21-6" name="__codelineno-21-6"></a><span class="w">    </span><span class="nt">labels</span><span class="p">:</span>
<a id="__codelineno-21-7" name="__codelineno-21-7"></a><span class="w">        </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp</span>
<a id="__codelineno-21-8" name="__codelineno-21-8"></a><span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">front-end</span>
<a id="__codelineno-21-9" name="__codelineno-21-9"></a>
<a id="__codelineno-21-10" name="__codelineno-21-10"></a><span class="nt">spec</span><span class="p">:</span>
<a id="__codelineno-21-11" name="__codelineno-21-11"></a><span class="w">    </span><span class="nt">template</span><span class="p">:</span>
<a id="__codelineno-21-12" name="__codelineno-21-12"></a><span class="w">        </span><span class="nt">metadata</span><span class="p">:</span>
<a id="__codelineno-21-13" name="__codelineno-21-13"></a><span class="w">            </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp-pod</span>
<a id="__codelineno-21-14" name="__codelineno-21-14"></a><span class="w">            </span><span class="nt">labels</span><span class="p">:</span>
<a id="__codelineno-21-15" name="__codelineno-21-15"></a><span class="w">                </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp</span>
<a id="__codelineno-21-16" name="__codelineno-21-16"></a><span class="w">                </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">front-end</span>
<a id="__codelineno-21-17" name="__codelineno-21-17"></a><span class="w">        </span><span class="nt">spec</span><span class="p">:</span>
<a id="__codelineno-21-18" name="__codelineno-21-18"></a><span class="w">            </span><span class="nt">containers</span><span class="p">:</span>
<a id="__codelineno-21-19" name="__codelineno-21-19"></a><span class="w">                </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx-container</span>
<a id="__codelineno-21-20" name="__codelineno-21-20"></a><span class="w">                  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx</span>
<a id="__codelineno-21-21" name="__codelineno-21-21"></a>
<a id="__codelineno-21-22" name="__codelineno-21-22"></a><span class="w">    </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<a id="__codelineno-21-23" name="__codelineno-21-23"></a><span class="w">    </span><span class="nt">selector</span><span class="p">:</span>
<a id="__codelineno-21-24" name="__codelineno-21-24"></a><span class="w">        </span><span class="nt">matchLabels</span><span class="p">:</span>
<a id="__codelineno-21-25" name="__codelineno-21-25"></a><span class="w">            </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">front-end</span>
</code></pre></div></td></tr></table></div>
<p>Peu de choses changent par rapport au fichier d'un <code>ReplicationController</code>.</p>
<ol>
<li>On doit changer la version : <code>apps/v1</code>.</li>
<li>Le <code>kind</code> change : <code>ReplicaSet</code></li>
<li>La partie <code>template</code> a exactement la même fonction que pour <code>ReplicationController</code>.</li>
</ol>
<p>La partie que change vraiment dans <code>spec</code> est la clé <code>selector</code>. C'est cette partie qui permet au <code>ReplicaSet</code> d'identifier quels sont les pods dont il doit se charger.</p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>Pourquoi définir quels sont les pods dont il doit se charger si l'on a déjà défini un template de pods dans le <code>ReplicaSet</code> ?</p>
</div>
<p>C'est parce que les <code>ReplicaSet</code> sont aussi capables de gérer des pods qui n'ont pas été créés en même temps que le <code>ReplicaSet</code>, même si ces pods ne sont pas dans le même noeud.</p>
<p>Une des façons d'identifier les pods que le <code>ReplicaSet</code> doit prendre en compte est de filtrer sur les labels définis dans les <code>metadata</code> des pods. Pour cela on utilise la clé <code>matchLabels</code>.</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">ReplicaSet va gérer tous les pods avec le label type: front-end</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-22-1">1</a></span>
<span class="normal"><a href="#__codelineno-22-2">2</a></span>
<span class="normal"><a href="#__codelineno-22-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1"></a><span class="w">    </span><span class="nt">selector</span><span class="p">:</span>
<a id="__codelineno-22-2" name="__codelineno-22-2"></a><span class="w">        </span><span class="nt">matchLabels</span><span class="p">:</span>
<a id="__codelineno-22-3" name="__codelineno-22-3"></a><span class="w">            </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">front-end</span>
</code></pre></div></td></tr></table></div>
<p>Le <code>selector</code> est la différence majeure entre <code>ReplicationController</code> et <code>ReplicaSet</code>.</p>
<p>On peut alors le créer avec la commande suivante.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-23-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1"></a>kubectl<span class="w"> </span>create<span class="w"> </span>-f<span class="w"> </span>replicaset-definition.yml
</code></pre></div></td></tr></table></div>
<p>Pour voir l'objet <code>ReplicaSet</code> on tape la commande suivante.</p>
<p><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-24-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1"></a>kubectl<span class="w"> </span>get<span class="w"> </span>replicaset
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-25-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1"></a>kubectl<span class="w"> </span>get<span class="w"> </span>rs
</code></pre></div></td></tr></table></div></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-26-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1"></a>kubectl<span class="w"> </span>describre<span class="w"> </span>replicaset<span class="w"> </span>replicaset-name
</code></pre></div></td></tr></table></div>
<p>On peut bien sur voir les pods créés avec la commande suivante.</p>
<p><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-27-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1"></a>kubectl<span class="w"> </span>get<span class="w"> </span>pods
</code></pre></div></td></tr></table></div>
Enfin, pour le détruire, on utilise la commande suivante.</p>
<p><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-28-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1"></a>kubectl<span class="w"> </span>delete<span class="w"> </span>replicaset<span class="w"> </span>myapp-replicaset
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-29-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1"></a>kubectl<span class="w"> </span>edit<span class="w"> </span>replicaset<span class="w"> </span>myapp-replicaset
</code></pre></div></td></tr></table></div>
Dans l'optique où le <code>ReplicaSet</code> est créé <strong>après</strong> que les pods avec les bons labels ont été créés, le <code>ReplicaSet</code> a tout de même besoin de la section <code>template</code>. Comme il est censé monitorer les pods et s'assurer que tous sont dispos, si des pods monitorés crashe, le <code>ReplicaSet</code> a besoin de connaître le <code>template</code> sur lequel il doit se baser pour recréer un nouveau pod.</p>
<h4 id="augmenter-le-nombre-de-repliques">Augmenter le nombre de répliques</h4>
<p>Si l'on souhaite augmenter le nombre de répliques d'un pod, dans un <code>ReplicaSet</code> ou un <code>ReplicationController</code>, une des solutions est de modifier en conséquence la section <code>replicas</code> de ces fichiers et de lancer une misa à jour avec la commande suivante.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-30-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1"></a>kubectl<span class="w"> </span>replace<span class="w"> </span>-f<span class="w"> </span>file.yml
</code></pre></div></td></tr></table></div>
<p>Une autre méthode est d'utiliser la commande <code>kubectl scale</code> :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-31-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1"></a>kubectl<span class="w"> </span>scale<span class="w"> </span>--replicas<span class="o">=</span><span class="m">6</span><span class="w"> </span>-f<span class="w"> </span>file.yml
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-32-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1"></a>kubectl<span class="w"> </span>scale<span class="w"> </span>--replicas<span class="o">=</span><span class="m">6</span><span class="w"> </span>replicaset<span class="w"> </span>myapp-replicaset
</code></pre></div></td></tr></table></div>
<h2 id="deployment"><code>Deployment</code></h2>
<p>Comment déployer son application dans un environnement de production ? En particulier on souhaite les caractéristiques suivantes.</p>
<ol>
<li>Déployer des instances de pods dans un <code>ReplicaSet</code> de façon simple.</li>
<li>Mettre à jour les conteneurs depuis le registre de façon automatisée.</li>
<li>Faire des mises à jour glissante pour éviter de rendre l'application complètement inaccessible au moment du déploiement de la maj.</li>
<li>Faire un rollback si nécessaire.</li>
<li>Mettre en pause les changements.</li>
<li>Les relancer.</li>
</ol>
<p>Tout ça se fait grâce à l'objet <code>Deployment</code> de k8s, qui est un objet de plus haut niveau que <code>ReplicaSet</code>.</p>
<pre class="mermaid"><code>graph TD
    subgraph Deployment
        subgraph ReplicaSet
                A1[pod &lt;br/&gt; conteneur python:3.8]
                A2[pod &lt;br/&gt; conteneur python:3.8]
                A3[pod &lt;br/&gt; conteneur python:3.8]
                A4[pod &lt;br/&gt; conteneur python:3.8]
                A5[pod &lt;br/&gt; conteneur python:3.8]
        end
    end</code></pre>
<p><div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">deployment-definition.yml</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-33-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-33-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-33-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-33-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-33-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-33-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-33-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-33-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-33-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-33-10">10</a></span>
<span class="normal"><a href="#__codelineno-33-11">11</a></span>
<span class="normal"><a href="#__codelineno-33-12">12</a></span>
<span class="normal"><a href="#__codelineno-33-13">13</a></span>
<span class="normal"><a href="#__codelineno-33-14">14</a></span>
<span class="normal"><a href="#__codelineno-33-15">15</a></span>
<span class="normal"><a href="#__codelineno-33-16">16</a></span>
<span class="normal"><a href="#__codelineno-33-17">17</a></span>
<span class="normal"><a href="#__codelineno-33-18">18</a></span>
<span class="normal"><a href="#__codelineno-33-19">19</a></span>
<span class="normal"><a href="#__codelineno-33-20">20</a></span>
<span class="normal"><a href="#__codelineno-33-21">21</a></span>
<span class="normal"><a href="#__codelineno-33-22">22</a></span>
<span class="normal"><a href="#__codelineno-33-23">23</a></span>
<span class="normal"><a href="#__codelineno-33-24">24</a></span>
<span class="normal"><a href="#__codelineno-33-25">25</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1"></a><span class="nn">---</span>
<a id="__codelineno-33-2" name="__codelineno-33-2"></a><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apps/v1</span>
<a id="__codelineno-33-3" name="__codelineno-33-3"></a><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Deployment</span>
<a id="__codelineno-33-4" name="__codelineno-33-4"></a><span class="nt">metadata</span><span class="p">:</span>
<a id="__codelineno-33-5" name="__codelineno-33-5"></a><span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp-deployment</span>
<a id="__codelineno-33-6" name="__codelineno-33-6"></a><span class="w">    </span><span class="nt">labels</span><span class="p">:</span>
<a id="__codelineno-33-7" name="__codelineno-33-7"></a><span class="w">        </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp</span>
<a id="__codelineno-33-8" name="__codelineno-33-8"></a><span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">front-end</span>
<a id="__codelineno-33-9" name="__codelineno-33-9"></a>
<a id="__codelineno-33-10" name="__codelineno-33-10"></a><span class="nt">spec</span><span class="p">:</span>
<a id="__codelineno-33-11" name="__codelineno-33-11"></a><span class="w">    </span><span class="nt">template</span><span class="p">:</span>
<a id="__codelineno-33-12" name="__codelineno-33-12"></a><span class="w">        </span><span class="nt">metadata</span><span class="p">:</span>
<a id="__codelineno-33-13" name="__codelineno-33-13"></a><span class="w">            </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp-pod</span>
<a id="__codelineno-33-14" name="__codelineno-33-14"></a><span class="w">            </span><span class="nt">labels</span><span class="p">:</span>
<a id="__codelineno-33-15" name="__codelineno-33-15"></a><span class="w">                </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp</span>
<a id="__codelineno-33-16" name="__codelineno-33-16"></a><span class="w">                </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">front-end</span>
<a id="__codelineno-33-17" name="__codelineno-33-17"></a><span class="w">        </span><span class="nt">spec</span><span class="p">:</span>
<a id="__codelineno-33-18" name="__codelineno-33-18"></a><span class="w">            </span><span class="nt">containers</span><span class="p">:</span>
<a id="__codelineno-33-19" name="__codelineno-33-19"></a><span class="w">                </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx-container</span>
<a id="__codelineno-33-20" name="__codelineno-33-20"></a><span class="w">                  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx</span>
<a id="__codelineno-33-21" name="__codelineno-33-21"></a>
<a id="__codelineno-33-22" name="__codelineno-33-22"></a><span class="w">    </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<a id="__codelineno-33-23" name="__codelineno-33-23"></a><span class="w">    </span><span class="nt">selector</span><span class="p">:</span>
<a id="__codelineno-33-24" name="__codelineno-33-24"></a><span class="w">        </span><span class="nt">matchLabels</span><span class="p">:</span>
<a id="__codelineno-33-25" name="__codelineno-33-25"></a><span class="w">            </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">front-end</span>
</code></pre></div></td></tr></table></div>
On peut alors le créer avec la commande suivante.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-34-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1"></a>kubectl<span class="w"> </span>create<span class="w"> </span>-f<span class="w"> </span>deployment-definition.yml
</code></pre></div></td></tr></table></div>
<p><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-35-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1"></a>kubectl<span class="w"> </span>create<span class="w"> </span>-f<span class="w"> </span>deployment-definition.yml<span class="w"> </span>--record
</code></pre></div></td></tr></table></div>
permet d'enregistrer les causes de changement.</p>
<p>Pour voir l'objet <code>Deployment</code> on tape la commande suivante.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-36-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1"></a>kubectl<span class="w"> </span>get<span class="w"> </span>deployment
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-37-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-37-1" name="__codelineno-37-1"></a>kubectl<span class="w"> </span>describre<span class="w"> </span>deployment<span class="w"> </span>deployment-name
</code></pre></div></td></tr></table></div>
<p>Un <code>Deployment</code> crée un <code>ReplicaSet</code>, que l'on peut voir avec la commande suivante.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-38-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-38-1" name="__codelineno-38-1"></a>kubectl<span class="w"> </span>get<span class="w"> </span>replicasets
</code></pre></div></td></tr></table></div>
<p>Qui lui même crée des pods que l'on peut voir avec la commande suivante.</p>
<p><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-39-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-39-1" name="__codelineno-39-1"></a>kubectl<span class="w"> </span>get<span class="w"> </span>pods
</code></pre></div></td></tr></table></div>
Enfin, pour le détruire, on utilise la commande suivante.</p>
<p><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-40-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-40-1" name="__codelineno-40-1"></a>kubectl<span class="w"> </span>delete<span class="w"> </span>deployment<span class="w"> </span>myapp-deployment
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-41-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-41-1" name="__codelineno-41-1"></a>kubectl<span class="w"> </span>edit<span class="w"> </span>deployment<span class="w"> </span>myapp-deployment
</code></pre></div></td></tr></table></div></p>
<p>Pour voir tous les objets k8s d'un même namespace, il est possible de d'utiliser la commande suivante.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-42-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-42-1" name="__codelineno-42-1"></a>kubectl<span class="w"> </span>get<span class="w"> </span>all
</code></pre></div></td></tr></table></div>
<h3 id="updates-et-rollback">Updates et Rollback</h3>
<p>Un <code>Deployment</code> déclenche un <code>rollout</code>. Chaque nouveau <code>rollout</code> crée une "Révision de déploiement".</p>
<pre class="mermaid"><code>graph TD
    subgraph Deployment Revision 1
        subgraph ReplicaSet1
                A1[pod &lt;br/&gt; conteneur python:3.8]
                A2[pod &lt;br/&gt; conteneur python:3.8]
                A3[pod &lt;br/&gt; conteneur python:3.8]
                A4[pod &lt;br/&gt; conteneur python:3.8]
                A5[pod &lt;br/&gt; conteneur python:3.8]
        end
    end
</code></pre>
<p>Lorsque que l'application est mise à jour, eg le conteneur change de version, un nouveau <code>rollout</code> est déclenché et crée une nouvelle "Révision de déploiement".</p>
<pre class="mermaid"><code>graph TD
    subgraph Deployment Revision 2
        subgraph ReplicaSet2
                B1[pod &lt;br/&gt; conteneur python:3.9]
                B2[pod &lt;br/&gt; conteneur python:3.9]
                B3[pod &lt;br/&gt; conteneur python:3.9]
                B4[pod &lt;br/&gt; conteneur python:3.9]
                B5[pod &lt;br/&gt; conteneur python:3.9]
        end
    end</code></pre>
<p>C'est ce qui permet de monitorer les déploiements et de revenir en arrière si nécessaire.</p>
<p>On peut voir le status du rollout avec la commande suivante.</p>
<p><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-43-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-43-1" name="__codelineno-43-1"></a>kubectl<span class="w"> </span>rollout<span class="w"> </span>status<span class="w"> </span>deployment_name
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-44-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-44-1" name="__codelineno-44-1"></a>kubectl<span class="w"> </span>rollout<span class="w"> </span><span class="nb">history</span><span class="w"> </span>deployment_name
</code></pre></div></td></tr></table></div></p>
<p>La stratégie par défaut pour mettre à jour le déploiement est de mettre à jour les pods un par un au fur et à mesure de leur disponibilité, plutôt que de tous les supprimer d'un coup et de rendre l'application incaccessible. C'est ce que k8s appelle un "rolling update".</p>
<p>Pratiquement, comment on fait la mise à jour ? Une fois les modifications faites dans le fichier de configuration <code>.yml</code>, on utilise la commande suivante.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-45-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-45-1" name="__codelineno-45-1"></a>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>deployment_file.yml
</code></pre></div></td></tr></table></div>
<p>Pour annuler la mise à jour et faire un rollback, on utilise la commande suivante.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-46-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-46-1" name="__codelineno-46-1"></a>kubectl<span class="w"> </span>rollout<span class="w"> </span>undo<span class="w"> </span>deployment/deployment_name
</code></pre></div></td></tr></table></div>
<h2 id="notion-de-reseaux-dans-kubernetes">Notion de réseaux dans kubernetes</h2>
<h3 id="cas-dun-noeud-unique">Cas d'un noeud unique</h3>
<p>Commençons simplement, un cluster avec un unique noeud contenant un unique pod python3.8.</p>
<pre class="mermaid"><code>graph LR

    subgraph cluster
        subgraph node
            A[pod &lt;br/&gt; conteneur python:3.8]
        end
    end</code></pre>
<p>Ce noeud possède une adresse ip, <code>192.168.1.2</code>, que l'on utilise pour accéder au noeud kubernetes. Par exemple via ssh.</p>
<pre class="mermaid"><code>graph LR

    subgraph cluster
        subgraph node
            A[pod &lt;br/&gt; conteneur python:3.8]
            B{{192.168.1.2}}
        end
    end</code></pre>
<div class="admonition info">
<p class="admonition-title">Remarque</p>
<p>Dans le cas de Minikube, l'adresse ip dont on parle ici est l'adresse ip du noeud Minikube à l'intérieur de l'hyperviseur. Votre système (Linux, Windows, etc) peut avoir une autre adresse.</p>
<pre class="mermaid"><code>graph LR
    subgraph Système
        subgraph noeud Minikube
            A[pod &lt;br/&gt; conteneur python:3.8]
            B{{192.168.1.2}}
        end
            C{{192.168.1.10}}
    end</code></pre>
</div>
<p>A la différence de Docker où une adresse ip est associée à un conteneur, <strong>dans kubernetes une adresse ip est assignée à un pod</strong>. Chaque pod possède donc sa propre adresse ip.</p>
<pre class="mermaid"><code>graph LR

    subgraph cluster
        subgraph node
            A[pod &lt;br/&gt; conteneur python:3.8 &lt;/br&gt; 10.244.0.2]
            B{{192.168.1.2}}
        end
    end</code></pre>
<p>Disons qu'ici l'adresse ip du pod est <code>10.224.0.2</code>.</p>
<p>Lorsque kubernetes est initialisé, un réseau privé interne (avec l'adresse <code>10.244.0.0</code>) est alors créé et tous les pods lui sont rattachés.</p>
<pre class="mermaid"><code>graph LR

    subgraph cluster
        subgraph node
            A[pod &lt;br/&gt; conteneur python:3.8 &lt;/br&gt; 10.244.0.2]
            B{{192.168.1.2}}
            C[[10.244.0.0]]
        end
    end
    C-.-A</code></pre>
<p>Chaque pod déployé se voit alors assigner une adresse ip par ce réseau. Il peuvent communiquer entre eux via cette ip.</p>
<pre class="mermaid"><code>graph LR

    subgraph cluster
        subgraph node
            A1[pod &lt;br/&gt; conteneur python:3.8 &lt;/br&gt; 10.244.0.2]
            A2[pod &lt;br/&gt; conteneur python:3.8 &lt;/br&gt; 10.244.0.3]
            A3[pod &lt;br/&gt; conteneur python:3.8 &lt;/br&gt; 10.244.0.4]
            B{{192.168.1.2}}
            C[[10.244.0.0]]
        end
    end
    C-.-A1 &amp; A2 &amp; A3</code></pre>
<h3 id="cas-de-plusieurs-noeuds">Cas de plusieurs noeuds</h3>
<p>On considère 2 noeuds, chacun de ces noeuds possède un pod et un réseau privé fournissant l'adresse ip du pod.</p>
<pre class="mermaid"><code>graph LR

    subgraph cluster
        subgraph node1
            A1[pod &lt;br/&gt; conteneur python:3.8 &lt;/br&gt; 10.244.0.2]
            C1[[10.244.0.0]]
            B1{{192.168.1.2}}
        end

        subgraph node2
            A2[pod &lt;br/&gt; conteneur python:3.8 &lt;/br&gt; 10.244.0.2]
            B2{{192.168.1.3}}
            C2[[10.244.0.0]]
        end
    C1 -.- Error -.- C2
    end

    A1 -.- C1
    A2 -.- C2</code></pre>
<p>Ces pods et réseaux internes ayant la même adresse ip, la communication entre ces deux noeuds dans un cluster sera impossible.</p>
<p>De façon générale dans un cluster, kubenertes ne gère pas de façon automatique les réseaux. Il s'attend à ce soit nous qui gérions la configuration réseau.</p>
<p>Dans la configuration du réseau, kubernetes demande que ces deux conditions soient remplies pour pouvoir fonctionner.</p>
<ul>
<li>Tous les pods, conteneurs, doivent pouvoir communiquer les uns avec les autres <strong>sans traduction d'adresse réseau</strong> (NAT).</li>
<li>Tous les noeuds peuvent communiquer avec tous les conteneurs, et inversement, <strong>sans traduction d'adresse réseau</strong>.</li>
</ul>
<div class="admonition info">
<p class="admonition-title">Network address translation</p>
<p>En réseau informatique, on dit qu'un routeur fait du <strong>network address translation</strong> (NAT, "traduction d'adresse réseau" ou parfois "translation d'adresse réseau") lorsqu'il fait correspondre des adresses IP à d'autres adresses IP.</p>
<p>En particulier, un cas courant est de permettre à des machines disposant d'adresses privées qui font partie d'un intranet et ne sont ni uniques ni routables à l'échelle d'Internet, de communiquer avec le reste d'Internet en utilisant vers l'extérieur des adresses externes publiques, uniques et routables.</p>
<p><a href="https://fr.wikipedia.org/wiki/Network_address_translation">Wikipedia</a></p>
</div>
<p>Kubernetes s'attend donc à ce que l'on mette en place une solution réseau qui satisfait ces 2 critères.</p>
<div class="admonition example">
<p class="admonition-title">Exemples</p>
<p>Pour pouvoir mettre en place une telle configuration réseau, des solutions open source existent, telles que <a href="https://www.tigera.io/project-calico/">Calico</a>, <a href="https://github.com/flannel-io/flannel">flannel</a>, ou <a href="https://www.vmware.com/fr/products/nsx.html">VMWare NSX</a> dans un environnement VMWare.</p>
</div>
<pre class="mermaid"><code>graph LR

    subgraph cluster
        subgraph node1
            A1[pod &lt;br/&gt; conteneur python:3.8 &lt;/br&gt; 10.244.0.2]
            C1[[10.244.0.0]]
            B1{{192.168.1.2}}
        end

        subgraph node2
            A2[pod &lt;br/&gt; conteneur python:3.8 &lt;/br&gt; 10.244.1.2]
            C2[[10.244.1.0]]
            B2{{192.168.1.3}}
        end
    D[[Routing]]
    C1 -.- D -.- C2
    end

    A1 -.- C1
    A2 -.- C2</code></pre>
<h2 id="les-services">Les <code>Services</code></h2>
<p>Les services permettent la communication entre différents composants à l'intérieur et à l'exterieur de kubernetes.</p>
<pre class="mermaid"><code>graph TD

    subgraph cluster
        subgraph node
            A[Utilisateur]
            B[pod &lt;br/&gt; conteneur frontend]
            C[pod &lt;br/&gt; conteneur backend]
            D[pod &lt;br/&gt; conteneur backend]

            A -.- Service1 -.- B
            C -.- Service2 -.- B
            D -.- Service3 -.- B
        end

    end</code></pre>
<p>Les services permettent donc un couplage faible entre les différents composants nécessaires.</p>
<p>Un service est simplement un moyen de faire correspondre logiquement des pods avec des politiques pour y accéder. N'oubliez pas que les pods sont des ressources éphémères et qu'aucun pod n'est jamais recréé une fois qu'il a été supprimé. Les services offrent donc un moyen de fournir une connexion à ces pods, quelle que soit leur adresse IP. Ceci est réalisé par l'utilisation du <code>selector</code>. Habituellement, dans le manifeste d'un déploiement, des tags sont fournies dans le modèle du pod ce qui sert à identifier et à regrouper les pod en fonction de nos besoins. Des <code>selector</code> sont ensuite définis dans le manifeste des services <strong>qui correspondent aux tags définis dans le manifeste du déploiement ou du pod</strong>. Pour chaque pod qui correspond au sélecteur, un endpoint est créé pour ce pod.</p>
<p>Nous allons maintenant discuter des différents types de services offerts (du moins les plus connus), du plus restreint au plus ouvert.</p>
<h3 id="clusterip">ClusterIP</h3>
<h3 id="nodeport">NodePort</h3>
<p>Prenons l'exemple suivant. On a un noeud d'ont l'adresse IP est <code>192.168.1.2</code> et un pod dont l'ip <code>10.244.0.2</code> est héritée du réseau <code>10.244.0.0</code>.</p>
<p>On a aussi un laptop qui est sur le même réseau que le noeud.</p>
<pre class="mermaid"><code>graph LR

    subgraph cluster
        subgraph node
            A1[pod &lt;br/&gt; conteneur FastAPI &lt;/br&gt; 10.244.0.2]
            B{{192.168.1.2}}
            C[[10.244.0.0]]
        end
    end
    C-.-A1

    D[Laptop &lt;/br&gt; 192.168.1.10]</code></pre>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>Comment accéder au pod depuis le laptop ?</p>
</div>
<p>Si l'on se connecte en ssh au noeud, on sera alors capable d'appeler le pod via un <code>curl http://10.244.0.2</code>.</p>
<pre class="mermaid"><code>graph LR

    subgraph cluster
        subgraph node
            A1[pod &lt;br/&gt; conteneur FastAPI &lt;/br&gt; 10.244.0.2]
            B{{192.168.1.2}}
            C[[10.244.0.0]]
        end
    end
    C-.-A1

    D[Laptop &lt;/br&gt; 192.168.1.10]
    D -.- ssh -.- B</code></pre>
<p>Mais on souhaite simplement être capable d'appeler le noeud via un <code>curl http://192.168.1.2</code>. On a donc besoin d'un intérmédiaire capable de faire le routage entre le laptop et le pod contenu dans le noeud.</p>
<p>Une telle solution est fournie par le service <code>NodePort</code>, qui mappe un port du noeud var un port du pod.</p>
<pre class="mermaid"><code>graph LR

    subgraph cluster
        subgraph node
            A1[pod &lt;br/&gt; conteneur FastAPI &lt;/br&gt; 10.244.0.2]
            B{{192.168.1.2}}
            C[[10.244.0.0]]
            E[port &lt;/br&gt; 30008]
            F[Service]
        end
    end
    C-.-A1

    D[Laptop &lt;/br&gt; 192.168.1.10]
    D -.- E -.- F -.- A1</code></pre>
<p>Dans le détail, on a 3 ports qui sont impliqués :</p>
<pre class="mermaid"><code>graph LR

    subgraph cluster
        subgraph node
            A1[pod &lt;br/&gt; port 80 &lt;/br&gt; 10.244.0.2]
            E[port &lt;/br&gt; 30008]
            F[Service &lt;/br&gt; port 80]
        end
    end

    E -.- F -.- A1</code></pre>
<ul>
<li>Le port 80 du pod, sur lequel tourne l'api, c'est celui auquel on veut avoir accès. On le nomme le <code>targetPort</code>.</li>
<li>Le port 80 du service, simplement nommé <code>port</code>.</li>
<li>Le port 30008 sur le noeud lui même qui permet un accès externe, le <code>nodePort</code>.</li>
</ul>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>Le port sur le noeud a pour valeur 30008 et sur un noeud les ports ne peuvent avoir que des valeurs comprises entre 30000 et 32767.</p>
</div>
<p>Les termes donnés ici sont du point du service. Le service est comme un serveur virtuel à l'intérieur du noeud. A l'intérieur du cluster, il possède sa propre adresse IP (l'ip cluster du service).</p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>Comment spécifier au service que le port 30 correspond au bon pod ? Il peut y avoir plusieurs milliers de pods dans le même noeud.</p>
</div>
<p>De la même façon que pour les <code>ReplicaSet</code>, les services possèdent une clé <code>selector</code> dans <code>spec</code> qui permet au service de filtrer les pods sur lesquels il doit s'appliquer par rapport aux tags.</p>
<p>Ainsi, pour le pod suivant qui possède les tags <code>app: myapp</code> et <code>type: front-end</code>, il suffit de les renseigner dans le <code>selector</code> du service.</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">pod-definition.yml</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-47-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-47-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-47-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-47-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-47-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-47-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-47-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-47-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-47-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-47-10">10</a></span>
<span class="normal"><a href="#__codelineno-47-11">11</a></span>
<span class="normal"><a href="#__codelineno-47-12">12</a></span>
<span class="normal"><a href="#__codelineno-47-13">13</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-47-1" name="__codelineno-47-1"></a><span class="nn">---</span>
<a id="__codelineno-47-2" name="__codelineno-47-2"></a><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<a id="__codelineno-47-3" name="__codelineno-47-3"></a><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Pod</span>
<a id="__codelineno-47-4" name="__codelineno-47-4"></a><span class="nt">metadata</span><span class="p">:</span>
<a id="__codelineno-47-5" name="__codelineno-47-5"></a><span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp-pod</span>
<a id="__codelineno-47-6" name="__codelineno-47-6"></a><span class="w">    </span><span class="nt">labels</span><span class="p">:</span>
<a id="__codelineno-47-7" name="__codelineno-47-7"></a><span class="w">        </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-app</span>
<a id="__codelineno-47-8" name="__codelineno-47-8"></a><span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">front-end</span>
<a id="__codelineno-47-9" name="__codelineno-47-9"></a>
<a id="__codelineno-47-10" name="__codelineno-47-10"></a><span class="nt">spec</span><span class="p">:</span>
<a id="__codelineno-47-11" name="__codelineno-47-11"></a><span class="w">    </span><span class="nt">containers</span><span class="p">:</span>
<a id="__codelineno-47-12" name="__codelineno-47-12"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx-container</span>
<a id="__codelineno-47-13" name="__codelineno-47-13"></a><span class="w">          </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx</span>
</code></pre></div></td></tr></table></div>
<p>De cette façon là.</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">service-definition.yml</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-48-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-48-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-48-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-48-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-48-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-48-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-48-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-48-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-48-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-48-10">10</a></span>
<span class="normal"><a href="#__codelineno-48-11">11</a></span>
<span class="normal"><a href="#__codelineno-48-12">12</a></span>
<span class="normal"><a href="#__codelineno-48-13">13</a></span>
<span class="normal"><a href="#__codelineno-48-14">14</a></span>
<span class="normal"><a href="#__codelineno-48-15">15</a></span>
<span class="normal"><a href="#__codelineno-48-16">16</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-48-1" name="__codelineno-48-1"></a><span class="nn">---</span>
<a id="__codelineno-48-2" name="__codelineno-48-2"></a><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<a id="__codelineno-48-3" name="__codelineno-48-3"></a><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Service</span>
<a id="__codelineno-48-4" name="__codelineno-48-4"></a><span class="nt">metadata</span><span class="p">:</span>
<a id="__codelineno-48-5" name="__codelineno-48-5"></a><span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp-service</span>
<a id="__codelineno-48-6" name="__codelineno-48-6"></a>
<a id="__codelineno-48-7" name="__codelineno-48-7"></a><span class="nt">spec</span><span class="p">:</span>
<a id="__codelineno-48-8" name="__codelineno-48-8"></a><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NodePort</span>
<a id="__codelineno-48-9" name="__codelineno-48-9"></a><span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<a id="__codelineno-48-10" name="__codelineno-48-10"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">targetPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80</span>
<a id="__codelineno-48-11" name="__codelineno-48-11"></a><span class="w">          </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80</span>
<a id="__codelineno-48-12" name="__codelineno-48-12"></a><span class="w">          </span><span class="nt">NodePort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">30008</span>
<a id="__codelineno-48-13" name="__codelineno-48-13"></a>
<a id="__codelineno-48-14" name="__codelineno-48-14"></a><span class="w">    </span><span class="nt">selector</span><span class="p">:</span>
<a id="__codelineno-48-15" name="__codelineno-48-15"></a><span class="w">        </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-app</span>
<a id="__codelineno-48-16" name="__codelineno-48-16"></a><span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">front-end</span>
</code></pre></div></td></tr></table></div>
<div class="admonition info">
<p class="admonition-title">Remarque</p>
<p>Si <code>targetPort</code> n'est pas défini, k8s supposera qu'il a la même valeur que <code>port</code>.</p>
</div>
<p>Si on a plusieurs pod avec le même tags, ie des pods définis via un <code>ReplicaSet</code> ou un <code>Deployment</code> le service de chargera du routage vers l'ensemble de ces répliques et agira comme load balancer, <strong>que les pods soient dans le même noeud ou non.</strong></p>
<p>Par conséquent,</p>
<ul>
<li>un seul pod dans un seul noeud,</li>
<li>plusieurs pods dans un seul noeud,</li>
<li>plusieurs pods dans plusieurs noeuds,</li>
</ul>
<p>cela ne change rien à la méthode de définition d'un service <code>NodePort</code> car kubernetes s'assure de le définir de manière transverse.</p>
<p>Pour lancer le service, on utilise la commande suivante.</p>
<p><code>kubectl create -f service-definition.yaml</code></p>
<p>Pour voir l'ensemble des services lancés dans le cluster, on peut utiliser la commande <code>kubectl get svc</code>, <code>svc</code> désigant service control.</p>
<p><strong>Sur Minikube</strong>, pour avoir accès à l'adresse qu'il faut utiliser pour contacter le pod, on peut taper la commande suivante.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-49-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-49-1" name="__codelineno-49-1"></a>minikube<span class="w"> </span>service<span class="w"> </span>myapp-service<span class="w"> </span>--url
</code></pre></div></td></tr></table></div>
<p>La commande nous affichera l'adresse pour contacter le pod, par exemple <code>http://192.168.99.101:30004</code>.</p>
<h3 id="loadblancer">Loadblancer</h3>
<p>Ne fonctionne que sur les plateformes Cloud.</p>
<h3 id="k8s-snippets">k8s snippets</h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-50-1">  1</a></span>
<span class="normal"><a href="#__codelineno-50-2">  2</a></span>
<span class="normal"><a href="#__codelineno-50-3">  3</a></span>
<span class="normal"><a href="#__codelineno-50-4">  4</a></span>
<span class="normal"><a href="#__codelineno-50-5">  5</a></span>
<span class="normal"><a href="#__codelineno-50-6">  6</a></span>
<span class="normal"><a href="#__codelineno-50-7">  7</a></span>
<span class="normal"><a href="#__codelineno-50-8">  8</a></span>
<span class="normal"><a href="#__codelineno-50-9">  9</a></span>
<span class="normal"><a href="#__codelineno-50-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-50-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-50-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-50-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-50-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-50-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-50-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-50-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-50-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-50-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-50-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-50-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-50-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-50-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-50-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-50-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-50-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-50-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-50-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-50-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-50-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-50-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-50-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-50-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-50-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-50-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-50-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-50-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-50-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-50-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-50-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-50-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-50-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-50-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-50-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-50-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-50-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-50-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-50-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-50-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-50-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-50-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-50-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-50-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-50-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-50-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-50-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-50-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-50-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-50-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-50-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-50-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-50-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-50-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-50-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-50-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-50-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-50-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-50-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-50-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-50-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-50-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-50-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-50-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-50-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-50-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-50-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-50-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-50-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-50-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-50-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-50-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-50-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-50-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-50-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-50-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-50-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-50-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-50-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-50-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-50-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-50-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-50-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-50-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-50-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-50-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-50-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-50-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-50-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-50-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-50-100">100</a></span>
<span class="normal"><a href="#__codelineno-50-101">101</a></span>
<span class="normal"><a href="#__codelineno-50-102">102</a></span>
<span class="normal"><a href="#__codelineno-50-103">103</a></span>
<span class="normal"><a href="#__codelineno-50-104">104</a></span>
<span class="normal"><a href="#__codelineno-50-105">105</a></span>
<span class="normal"><a href="#__codelineno-50-106">106</a></span>
<span class="normal"><a href="#__codelineno-50-107">107</a></span>
<span class="normal"><a href="#__codelineno-50-108">108</a></span>
<span class="normal"><a href="#__codelineno-50-109">109</a></span>
<span class="normal"><a href="#__codelineno-50-110">110</a></span>
<span class="normal"><a href="#__codelineno-50-111">111</a></span>
<span class="normal"><a href="#__codelineno-50-112">112</a></span>
<span class="normal"><a href="#__codelineno-50-113">113</a></span>
<span class="normal"><a href="#__codelineno-50-114">114</a></span>
<span class="normal"><a href="#__codelineno-50-115">115</a></span>
<span class="normal"><a href="#__codelineno-50-116">116</a></span>
<span class="normal"><a href="#__codelineno-50-117">117</a></span>
<span class="normal"><a href="#__codelineno-50-118">118</a></span>
<span class="normal"><a href="#__codelineno-50-119">119</a></span>
<span class="normal"><a href="#__codelineno-50-120">120</a></span>
<span class="normal"><a href="#__codelineno-50-121">121</a></span>
<span class="normal"><a href="#__codelineno-50-122">122</a></span>
<span class="normal"><a href="#__codelineno-50-123">123</a></span>
<span class="normal"><a href="#__codelineno-50-124">124</a></span>
<span class="normal"><a href="#__codelineno-50-125">125</a></span>
<span class="normal"><a href="#__codelineno-50-126">126</a></span>
<span class="normal"><a href="#__codelineno-50-127">127</a></span>
<span class="normal"><a href="#__codelineno-50-128">128</a></span>
<span class="normal"><a href="#__codelineno-50-129">129</a></span>
<span class="normal"><a href="#__codelineno-50-130">130</a></span>
<span class="normal"><a href="#__codelineno-50-131">131</a></span>
<span class="normal"><a href="#__codelineno-50-132">132</a></span>
<span class="normal"><a href="#__codelineno-50-133">133</a></span>
<span class="normal"><a href="#__codelineno-50-134">134</a></span>
<span class="normal"><a href="#__codelineno-50-135">135</a></span>
<span class="normal"><a href="#__codelineno-50-136">136</a></span>
<span class="normal"><a href="#__codelineno-50-137">137</a></span>
<span class="normal"><a href="#__codelineno-50-138">138</a></span>
<span class="normal"><a href="#__codelineno-50-139">139</a></span>
<span class="normal"><a href="#__codelineno-50-140">140</a></span>
<span class="normal"><a href="#__codelineno-50-141">141</a></span>
<span class="normal"><a href="#__codelineno-50-142">142</a></span>
<span class="normal"><a href="#__codelineno-50-143">143</a></span>
<span class="normal"><a href="#__codelineno-50-144">144</a></span>
<span class="normal"><a href="#__codelineno-50-145">145</a></span>
<span class="normal"><a href="#__codelineno-50-146">146</a></span>
<span class="normal"><a href="#__codelineno-50-147">147</a></span>
<span class="normal"><a href="#__codelineno-50-148">148</a></span>
<span class="normal"><a href="#__codelineno-50-149">149</a></span>
<span class="normal"><a href="#__codelineno-50-150">150</a></span>
<span class="normal"><a href="#__codelineno-50-151">151</a></span>
<span class="normal"><a href="#__codelineno-50-152">152</a></span>
<span class="normal"><a href="#__codelineno-50-153">153</a></span>
<span class="normal"><a href="#__codelineno-50-154">154</a></span>
<span class="normal"><a href="#__codelineno-50-155">155</a></span>
<span class="normal"><a href="#__codelineno-50-156">156</a></span>
<span class="normal"><a href="#__codelineno-50-157">157</a></span>
<span class="normal"><a href="#__codelineno-50-158">158</a></span>
<span class="normal"><a href="#__codelineno-50-159">159</a></span>
<span class="normal"><a href="#__codelineno-50-160">160</a></span>
<span class="normal"><a href="#__codelineno-50-161">161</a></span>
<span class="normal"><a href="#__codelineno-50-162">162</a></span>
<span class="normal"><a href="#__codelineno-50-163">163</a></span>
<span class="normal"><a href="#__codelineno-50-164">164</a></span>
<span class="normal"><a href="#__codelineno-50-165">165</a></span>
<span class="normal"><a href="#__codelineno-50-166">166</a></span>
<span class="normal"><a href="#__codelineno-50-167">167</a></span>
<span class="normal"><a href="#__codelineno-50-168">168</a></span>
<span class="normal"><a href="#__codelineno-50-169">169</a></span>
<span class="normal"><a href="#__codelineno-50-170">170</a></span>
<span class="normal"><a href="#__codelineno-50-171">171</a></span>
<span class="normal"><a href="#__codelineno-50-172">172</a></span>
<span class="normal"><a href="#__codelineno-50-173">173</a></span>
<span class="normal"><a href="#__codelineno-50-174">174</a></span>
<span class="normal"><a href="#__codelineno-50-175">175</a></span>
<span class="normal"><a href="#__codelineno-50-176">176</a></span>
<span class="normal"><a href="#__codelineno-50-177">177</a></span>
<span class="normal"><a href="#__codelineno-50-178">178</a></span>
<span class="normal"><a href="#__codelineno-50-179">179</a></span>
<span class="normal"><a href="#__codelineno-50-180">180</a></span>
<span class="normal"><a href="#__codelineno-50-181">181</a></span>
<span class="normal"><a href="#__codelineno-50-182">182</a></span>
<span class="normal"><a href="#__codelineno-50-183">183</a></span>
<span class="normal"><a href="#__codelineno-50-184">184</a></span>
<span class="normal"><a href="#__codelineno-50-185">185</a></span>
<span class="normal"><a href="#__codelineno-50-186">186</a></span>
<span class="normal"><a href="#__codelineno-50-187">187</a></span>
<span class="normal"><a href="#__codelineno-50-188">188</a></span>
<span class="normal"><a href="#__codelineno-50-189">189</a></span>
<span class="normal"><a href="#__codelineno-50-190">190</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-50-1" name="__codelineno-50-1"></a><span class="p">{</span>
<a id="__codelineno-50-2" name="__codelineno-50-2"></a><span class="w">    </span><span class="nt">&quot;k8s Pod&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-50-3" name="__codelineno-50-3"></a><span class="w">        </span><span class="nt">&quot;prefix&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;k-pod&quot;</span><span class="p">,</span>
<a id="__codelineno-50-4" name="__codelineno-50-4"></a><span class="w">        </span><span class="nt">&quot;body&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<a id="__codelineno-50-5" name="__codelineno-50-5"></a><span class="w">            </span><span class="s2">&quot;apiVersion: v1&quot;</span><span class="p">,</span>
<a id="__codelineno-50-6" name="__codelineno-50-6"></a><span class="w">            </span><span class="s2">&quot;kind: Pod&quot;</span><span class="p">,</span>
<a id="__codelineno-50-7" name="__codelineno-50-7"></a><span class="w">            </span><span class="s2">&quot;metadata:&quot;</span><span class="p">,</span>
<a id="__codelineno-50-8" name="__codelineno-50-8"></a><span class="w">            </span><span class="s2">&quot;\tcreationTimestamp:&quot;</span><span class="p">,</span>
<a id="__codelineno-50-9" name="__codelineno-50-9"></a><span class="w">            </span><span class="s2">&quot;\tname: pod-name&quot;</span><span class="p">,</span>
<a id="__codelineno-50-10" name="__codelineno-50-10"></a><span class="w">            </span><span class="s2">&quot;\tlabels:&quot;</span><span class="p">,</span>
<a id="__codelineno-50-11" name="__codelineno-50-11"></a><span class="w">            </span><span class="s2">&quot;\t\tapp: my-app&quot;</span><span class="p">,</span>
<a id="__codelineno-50-12" name="__codelineno-50-12"></a><span class="w">            </span><span class="s2">&quot;\t\ttype: front-end&quot;</span><span class="p">,</span>
<a id="__codelineno-50-13" name="__codelineno-50-13"></a><span class="w">            </span><span class="s2">&quot;\t\tkey3: value3&quot;</span><span class="p">,</span>
<a id="__codelineno-50-14" name="__codelineno-50-14"></a>
<a id="__codelineno-50-15" name="__codelineno-50-15"></a><span class="w">            </span><span class="s2">&quot;spec:&quot;</span><span class="p">,</span>
<a id="__codelineno-50-16" name="__codelineno-50-16"></a><span class="w">            </span><span class="s2">&quot;\tcontainers:&quot;</span><span class="p">,</span>
<a id="__codelineno-50-17" name="__codelineno-50-17"></a><span class="w">            </span><span class="s2">&quot;\t\t- name: nginx-container&quot;</span><span class="p">,</span>
<a id="__codelineno-50-18" name="__codelineno-50-18"></a><span class="w">            </span><span class="s2">&quot;\t\t  image: nginx&quot;</span><span class="p">,</span>
<a id="__codelineno-50-19" name="__codelineno-50-19"></a><span class="w">            </span><span class="s2">&quot;\t\t  resources: {}&quot;</span><span class="p">,</span>
<a id="__codelineno-50-20" name="__codelineno-50-20"></a><span class="w">            </span><span class="s2">&quot;\trestartPolicy: Always&quot;</span><span class="p">,</span>
<a id="__codelineno-50-21" name="__codelineno-50-21"></a>
<a id="__codelineno-50-22" name="__codelineno-50-22"></a><span class="w">            </span><span class="s2">&quot;status: {}\n&quot;</span><span class="p">,</span>
<a id="__codelineno-50-23" name="__codelineno-50-23"></a><span class="w">            </span><span class="s2">&quot;---&quot;</span><span class="p">,</span>
<a id="__codelineno-50-24" name="__codelineno-50-24"></a>
<a id="__codelineno-50-25" name="__codelineno-50-25"></a><span class="w">        </span><span class="p">],</span>
<a id="__codelineno-50-26" name="__codelineno-50-26"></a><span class="w">        </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;k8s Pod&quot;</span>
<a id="__codelineno-50-27" name="__codelineno-50-27"></a><span class="w">    </span><span class="p">},</span>
<a id="__codelineno-50-28" name="__codelineno-50-28"></a>
<a id="__codelineno-50-29" name="__codelineno-50-29"></a><span class="w">    </span><span class="nt">&quot;k8s ReplicationController&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-50-30" name="__codelineno-50-30"></a><span class="w">        </span><span class="nt">&quot;prefix&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;k-replication-controller&quot;</span><span class="p">,</span>
<a id="__codelineno-50-31" name="__codelineno-50-31"></a><span class="w">        </span><span class="nt">&quot;body&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<a id="__codelineno-50-32" name="__codelineno-50-32"></a><span class="w">            </span><span class="s2">&quot;apiVersion: v1&quot;</span><span class="p">,</span>
<a id="__codelineno-50-33" name="__codelineno-50-33"></a><span class="w">            </span><span class="s2">&quot;kind: ReplicationController&quot;</span><span class="p">,</span>
<a id="__codelineno-50-34" name="__codelineno-50-34"></a><span class="w">            </span><span class="s2">&quot;metadata:&quot;</span><span class="p">,</span>
<a id="__codelineno-50-35" name="__codelineno-50-35"></a><span class="w">            </span><span class="s2">&quot;\tname: rc-name&quot;</span><span class="p">,</span>
<a id="__codelineno-50-36" name="__codelineno-50-36"></a><span class="w">            </span><span class="s2">&quot;\tlabels:&quot;</span><span class="p">,</span>
<a id="__codelineno-50-37" name="__codelineno-50-37"></a><span class="w">            </span><span class="s2">&quot;\t\tapp: my-app&quot;</span><span class="p">,</span>
<a id="__codelineno-50-38" name="__codelineno-50-38"></a><span class="w">            </span><span class="s2">&quot;\t\ttype: front-end&quot;</span><span class="p">,</span>
<a id="__codelineno-50-39" name="__codelineno-50-39"></a><span class="w">            </span><span class="s2">&quot;\t\tkey3: value3&quot;</span><span class="p">,</span>
<a id="__codelineno-50-40" name="__codelineno-50-40"></a>
<a id="__codelineno-50-41" name="__codelineno-50-41"></a><span class="w">            </span><span class="s2">&quot;spec:&quot;</span><span class="p">,</span>
<a id="__codelineno-50-42" name="__codelineno-50-42"></a><span class="w">            </span><span class="s2">&quot;\ttemplate:&quot;</span><span class="p">,</span>
<a id="__codelineno-50-43" name="__codelineno-50-43"></a><span class="w">            </span><span class="s2">&quot;\t\tmetadata:&quot;</span><span class="p">,</span>
<a id="__codelineno-50-44" name="__codelineno-50-44"></a><span class="w">            </span><span class="s2">&quot;\t\t\tname: rc-name&quot;</span><span class="p">,</span>
<a id="__codelineno-50-45" name="__codelineno-50-45"></a><span class="w">            </span><span class="s2">&quot;\t\t\tlabels:&quot;</span><span class="p">,</span>
<a id="__codelineno-50-46" name="__codelineno-50-46"></a><span class="w">            </span><span class="s2">&quot;\t\t\t\tapp: my-app&quot;</span><span class="p">,</span>
<a id="__codelineno-50-47" name="__codelineno-50-47"></a><span class="w">            </span><span class="s2">&quot;\t\t\t\ttype: front-end&quot;</span><span class="p">,</span>
<a id="__codelineno-50-48" name="__codelineno-50-48"></a><span class="w">            </span><span class="s2">&quot;\t\t\t\tkey3: value3&quot;</span><span class="p">,</span>
<a id="__codelineno-50-49" name="__codelineno-50-49"></a><span class="w">            </span><span class="s2">&quot;\t\tspec:&quot;</span><span class="p">,</span>
<a id="__codelineno-50-50" name="__codelineno-50-50"></a><span class="w">            </span><span class="s2">&quot;\t\t\tcontainers:&quot;</span><span class="p">,</span>
<a id="__codelineno-50-51" name="__codelineno-50-51"></a><span class="w">            </span><span class="s2">&quot;\t\t\t\t- name: container-name&quot;</span><span class="p">,</span>
<a id="__codelineno-50-52" name="__codelineno-50-52"></a><span class="w">            </span><span class="s2">&quot;\t\t\t\t  image: image-name&quot;</span><span class="p">,</span>
<a id="__codelineno-50-53" name="__codelineno-50-53"></a>
<a id="__codelineno-50-54" name="__codelineno-50-54"></a><span class="w">            </span><span class="s2">&quot;\treplicas: 3\n&quot;</span><span class="p">,</span>
<a id="__codelineno-50-55" name="__codelineno-50-55"></a><span class="w">            </span><span class="s2">&quot;---&quot;</span><span class="p">,</span>
<a id="__codelineno-50-56" name="__codelineno-50-56"></a><span class="w">        </span><span class="p">],</span>
<a id="__codelineno-50-57" name="__codelineno-50-57"></a><span class="w">        </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;k8s ReplicationController&quot;</span>
<a id="__codelineno-50-58" name="__codelineno-50-58"></a><span class="w">    </span><span class="p">},</span>
<a id="__codelineno-50-59" name="__codelineno-50-59"></a>
<a id="__codelineno-50-60" name="__codelineno-50-60"></a><span class="w">    </span><span class="nt">&quot;k8s ReplicaSet&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-50-61" name="__codelineno-50-61"></a><span class="w">        </span><span class="nt">&quot;prefix&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;k-replicaset&quot;</span><span class="p">,</span>
<a id="__codelineno-50-62" name="__codelineno-50-62"></a><span class="w">        </span><span class="nt">&quot;body&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<a id="__codelineno-50-63" name="__codelineno-50-63"></a><span class="w">            </span><span class="s2">&quot;apiVersion: apps/v1&quot;</span><span class="p">,</span>
<a id="__codelineno-50-64" name="__codelineno-50-64"></a><span class="w">            </span><span class="s2">&quot;kind: ReplicaSet&quot;</span><span class="p">,</span>
<a id="__codelineno-50-65" name="__codelineno-50-65"></a><span class="w">            </span><span class="s2">&quot;metadata:&quot;</span><span class="p">,</span>
<a id="__codelineno-50-66" name="__codelineno-50-66"></a><span class="w">            </span><span class="s2">&quot;\tname: replicaset-name&quot;</span><span class="p">,</span>
<a id="__codelineno-50-67" name="__codelineno-50-67"></a><span class="w">            </span><span class="s2">&quot;\tlabels:&quot;</span><span class="p">,</span>
<a id="__codelineno-50-68" name="__codelineno-50-68"></a><span class="w">            </span><span class="s2">&quot;\t\tapp: my-app&quot;</span><span class="p">,</span>
<a id="__codelineno-50-69" name="__codelineno-50-69"></a><span class="w">            </span><span class="s2">&quot;\t\ttype: front-end&quot;</span><span class="p">,</span>
<a id="__codelineno-50-70" name="__codelineno-50-70"></a><span class="w">            </span><span class="s2">&quot;\t\tkey3: value3&quot;</span><span class="p">,</span>
<a id="__codelineno-50-71" name="__codelineno-50-71"></a>
<a id="__codelineno-50-72" name="__codelineno-50-72"></a><span class="w">            </span><span class="s2">&quot;spec:&quot;</span><span class="p">,</span>
<a id="__codelineno-50-73" name="__codelineno-50-73"></a><span class="w">            </span><span class="s2">&quot;\ttemplate:&quot;</span><span class="p">,</span>
<a id="__codelineno-50-74" name="__codelineno-50-74"></a><span class="w">            </span><span class="s2">&quot;\t\tmetadata:&quot;</span><span class="p">,</span>
<a id="__codelineno-50-75" name="__codelineno-50-75"></a><span class="w">            </span><span class="s2">&quot;\t\t\tname: rc-name&quot;</span><span class="p">,</span>
<a id="__codelineno-50-76" name="__codelineno-50-76"></a><span class="w">            </span><span class="s2">&quot;\t\t\tlabels:&quot;</span><span class="p">,</span>
<a id="__codelineno-50-77" name="__codelineno-50-77"></a><span class="w">            </span><span class="s2">&quot;\t\t\t\tapp: my-app&quot;</span><span class="p">,</span>
<a id="__codelineno-50-78" name="__codelineno-50-78"></a><span class="w">            </span><span class="s2">&quot;\t\t\t\ttype: front-end&quot;</span><span class="p">,</span>
<a id="__codelineno-50-79" name="__codelineno-50-79"></a><span class="w">            </span><span class="s2">&quot;\t\t\t\tkey3: value3&quot;</span><span class="p">,</span>
<a id="__codelineno-50-80" name="__codelineno-50-80"></a><span class="w">            </span><span class="s2">&quot;\t\tspec:&quot;</span><span class="p">,</span>
<a id="__codelineno-50-81" name="__codelineno-50-81"></a><span class="w">            </span><span class="s2">&quot;\t\t\tcontainers:&quot;</span><span class="p">,</span>
<a id="__codelineno-50-82" name="__codelineno-50-82"></a><span class="w">            </span><span class="s2">&quot;\t\t\t\t- name: container-name&quot;</span><span class="p">,</span>
<a id="__codelineno-50-83" name="__codelineno-50-83"></a><span class="w">            </span><span class="s2">&quot;\t\t\t\t  image: image-name&quot;</span><span class="p">,</span>
<a id="__codelineno-50-84" name="__codelineno-50-84"></a>
<a id="__codelineno-50-85" name="__codelineno-50-85"></a><span class="w">            </span><span class="s2">&quot;\treplicas: 3&quot;</span><span class="p">,</span>
<a id="__codelineno-50-86" name="__codelineno-50-86"></a><span class="w">            </span><span class="s2">&quot;\tselector:&quot;</span><span class="p">,</span>
<a id="__codelineno-50-87" name="__codelineno-50-87"></a><span class="w">            </span><span class="s2">&quot;\t\tmatchLabels:&quot;</span><span class="p">,</span>
<a id="__codelineno-50-88" name="__codelineno-50-88"></a><span class="w">            </span><span class="s2">&quot;\t\t\ttype: front-end\n&quot;</span><span class="p">,</span>
<a id="__codelineno-50-89" name="__codelineno-50-89"></a><span class="w">            </span><span class="s2">&quot;---&quot;</span><span class="p">,</span>
<a id="__codelineno-50-90" name="__codelineno-50-90"></a><span class="w">        </span><span class="p">],</span>
<a id="__codelineno-50-91" name="__codelineno-50-91"></a><span class="w">        </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;k8s ReplicaSet&quot;</span>
<a id="__codelineno-50-92" name="__codelineno-50-92"></a><span class="w">    </span><span class="p">},</span>
<a id="__codelineno-50-93" name="__codelineno-50-93"></a>
<a id="__codelineno-50-94" name="__codelineno-50-94"></a><span class="w">    </span><span class="nt">&quot;k8s Deployment&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-50-95" name="__codelineno-50-95"></a><span class="w">        </span><span class="nt">&quot;prefix&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;k-deployment&quot;</span><span class="p">,</span>
<a id="__codelineno-50-96" name="__codelineno-50-96"></a><span class="w">        </span><span class="nt">&quot;body&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<a id="__codelineno-50-97" name="__codelineno-50-97"></a><span class="w">            </span><span class="s2">&quot;apiVersion: apps/v1&quot;</span><span class="p">,</span>
<a id="__codelineno-50-98" name="__codelineno-50-98"></a><span class="w">            </span><span class="s2">&quot;kind: Deployment&quot;</span><span class="p">,</span>
<a id="__codelineno-50-99" name="__codelineno-50-99"></a><span class="w">            </span><span class="s2">&quot;metadata:&quot;</span><span class="p">,</span>
<a id="__codelineno-50-100" name="__codelineno-50-100"></a><span class="w">            </span><span class="s2">&quot;\tname: myapp-deployment&quot;</span><span class="p">,</span>
<a id="__codelineno-50-101" name="__codelineno-50-101"></a><span class="w">            </span><span class="s2">&quot;\tlabels:&quot;</span><span class="p">,</span>
<a id="__codelineno-50-102" name="__codelineno-50-102"></a><span class="w">            </span><span class="s2">&quot;\t\tapp: my-app&quot;</span><span class="p">,</span>
<a id="__codelineno-50-103" name="__codelineno-50-103"></a><span class="w">            </span><span class="s2">&quot;\t\ttype: front-end&quot;</span><span class="p">,</span>
<a id="__codelineno-50-104" name="__codelineno-50-104"></a><span class="w">            </span><span class="s2">&quot;\t\tkey3: value3&quot;</span><span class="p">,</span>
<a id="__codelineno-50-105" name="__codelineno-50-105"></a>
<a id="__codelineno-50-106" name="__codelineno-50-106"></a><span class="w">            </span><span class="s2">&quot;spec:&quot;</span><span class="p">,</span>
<a id="__codelineno-50-107" name="__codelineno-50-107"></a><span class="w">            </span><span class="s2">&quot;\ttemplate:&quot;</span><span class="p">,</span>
<a id="__codelineno-50-108" name="__codelineno-50-108"></a><span class="w">            </span><span class="s2">&quot;\t\tmetadata:&quot;</span><span class="p">,</span>
<a id="__codelineno-50-109" name="__codelineno-50-109"></a><span class="w">            </span><span class="s2">&quot;\t\t\tname: myapp-pod&quot;</span><span class="p">,</span>
<a id="__codelineno-50-110" name="__codelineno-50-110"></a><span class="w">            </span><span class="s2">&quot;\t\t\tlabels:&quot;</span><span class="p">,</span>
<a id="__codelineno-50-111" name="__codelineno-50-111"></a><span class="w">            </span><span class="s2">&quot;\t\t\t\tapp: my-app&quot;</span><span class="p">,</span>
<a id="__codelineno-50-112" name="__codelineno-50-112"></a><span class="w">            </span><span class="s2">&quot;\t\t\t\ttype: front-end&quot;</span><span class="p">,</span>
<a id="__codelineno-50-113" name="__codelineno-50-113"></a><span class="w">            </span><span class="s2">&quot;\t\t\t\tkey3: value3&quot;</span><span class="p">,</span>
<a id="__codelineno-50-114" name="__codelineno-50-114"></a><span class="w">            </span><span class="s2">&quot;\t\tspec:&quot;</span><span class="p">,</span>
<a id="__codelineno-50-115" name="__codelineno-50-115"></a><span class="w">            </span><span class="s2">&quot;\t\t\tcontainers:&quot;</span><span class="p">,</span>
<a id="__codelineno-50-116" name="__codelineno-50-116"></a><span class="w">            </span><span class="s2">&quot;\t\t\t\t- name: container-name&quot;</span><span class="p">,</span>
<a id="__codelineno-50-117" name="__codelineno-50-117"></a><span class="w">            </span><span class="s2">&quot;\t\t\t\t  image: image-name&quot;</span><span class="p">,</span>
<a id="__codelineno-50-118" name="__codelineno-50-118"></a>
<a id="__codelineno-50-119" name="__codelineno-50-119"></a><span class="w">            </span><span class="s2">&quot;\treplicas: 3&quot;</span><span class="p">,</span>
<a id="__codelineno-50-120" name="__codelineno-50-120"></a><span class="w">            </span><span class="s2">&quot;\tselector:&quot;</span><span class="p">,</span>
<a id="__codelineno-50-121" name="__codelineno-50-121"></a><span class="w">            </span><span class="s2">&quot;\t\tmatchLabels:&quot;</span><span class="p">,</span>
<a id="__codelineno-50-122" name="__codelineno-50-122"></a><span class="w">            </span><span class="s2">&quot;\t\t\ttype: front-end\n&quot;</span><span class="p">,</span>
<a id="__codelineno-50-123" name="__codelineno-50-123"></a><span class="w">            </span><span class="s2">&quot;---&quot;</span><span class="p">,</span>
<a id="__codelineno-50-124" name="__codelineno-50-124"></a><span class="w">        </span><span class="p">],</span>
<a id="__codelineno-50-125" name="__codelineno-50-125"></a><span class="w">        </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;k8s Deployment&quot;</span>
<a id="__codelineno-50-126" name="__codelineno-50-126"></a><span class="w">    </span><span class="p">},</span>
<a id="__codelineno-50-127" name="__codelineno-50-127"></a>
<a id="__codelineno-50-128" name="__codelineno-50-128"></a><span class="w">    </span><span class="nt">&quot;k8s NodePort&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-50-129" name="__codelineno-50-129"></a><span class="w">        </span><span class="nt">&quot;prefix&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;k-nodeport&quot;</span><span class="p">,</span>
<a id="__codelineno-50-130" name="__codelineno-50-130"></a><span class="w">        </span><span class="nt">&quot;body&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<a id="__codelineno-50-131" name="__codelineno-50-131"></a><span class="w">            </span><span class="s2">&quot;apiVersion: v1&quot;</span><span class="p">,</span>
<a id="__codelineno-50-132" name="__codelineno-50-132"></a><span class="w">            </span><span class="s2">&quot;kind: Service&quot;</span><span class="p">,</span>
<a id="__codelineno-50-133" name="__codelineno-50-133"></a><span class="w">            </span><span class="s2">&quot;metadata:&quot;</span><span class="p">,</span>
<a id="__codelineno-50-134" name="__codelineno-50-134"></a><span class="w">            </span><span class="s2">&quot;\tname: myapp-service\n&quot;</span><span class="p">,</span>
<a id="__codelineno-50-135" name="__codelineno-50-135"></a><span class="w">            </span><span class="s2">&quot;spec:&quot;</span><span class="p">,</span>
<a id="__codelineno-50-136" name="__codelineno-50-136"></a><span class="w">            </span><span class="s2">&quot;\ttype: NodePort&quot;</span><span class="p">,</span>
<a id="__codelineno-50-137" name="__codelineno-50-137"></a><span class="w">            </span><span class="s2">&quot;\tports:&quot;</span><span class="p">,</span>
<a id="__codelineno-50-138" name="__codelineno-50-138"></a><span class="w">            </span><span class="s2">&quot;\t\t- targetPort: 80&quot;</span><span class="p">,</span>
<a id="__codelineno-50-139" name="__codelineno-50-139"></a><span class="w">            </span><span class="s2">&quot;\t\t  port: 80&quot;</span><span class="p">,</span>
<a id="__codelineno-50-140" name="__codelineno-50-140"></a><span class="w">            </span><span class="s2">&quot;\t\t  NodePort: 30008\n&quot;</span><span class="p">,</span>
<a id="__codelineno-50-141" name="__codelineno-50-141"></a><span class="w">            </span><span class="s2">&quot;\tselector:&quot;</span><span class="p">,</span>
<a id="__codelineno-50-142" name="__codelineno-50-142"></a><span class="w">            </span><span class="s2">&quot;\t\tapp: my-app&quot;</span><span class="p">,</span>
<a id="__codelineno-50-143" name="__codelineno-50-143"></a><span class="w">            </span><span class="s2">&quot;\t\ttype: front-end\n&quot;</span><span class="p">,</span>
<a id="__codelineno-50-144" name="__codelineno-50-144"></a><span class="w">            </span><span class="s2">&quot;---&quot;</span><span class="p">,</span>
<a id="__codelineno-50-145" name="__codelineno-50-145"></a><span class="w">        </span><span class="p">],</span>
<a id="__codelineno-50-146" name="__codelineno-50-146"></a><span class="w">        </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;k8s NodePort&quot;</span>
<a id="__codelineno-50-147" name="__codelineno-50-147"></a><span class="w">    </span><span class="p">},</span>
<a id="__codelineno-50-148" name="__codelineno-50-148"></a>
<a id="__codelineno-50-149" name="__codelineno-50-149"></a><span class="w">    </span><span class="nt">&quot;k8s ClusterIP&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-50-150" name="__codelineno-50-150"></a><span class="w">        </span><span class="nt">&quot;prefix&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;k-clusterip&quot;</span><span class="p">,</span>
<a id="__codelineno-50-151" name="__codelineno-50-151"></a><span class="w">        </span><span class="nt">&quot;body&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<a id="__codelineno-50-152" name="__codelineno-50-152"></a><span class="w">            </span><span class="s2">&quot;apiVersion: v1&quot;</span><span class="p">,</span>
<a id="__codelineno-50-153" name="__codelineno-50-153"></a><span class="w">            </span><span class="s2">&quot;kind: Service&quot;</span><span class="p">,</span>
<a id="__codelineno-50-154" name="__codelineno-50-154"></a><span class="w">            </span><span class="s2">&quot;metadata:&quot;</span><span class="p">,</span>
<a id="__codelineno-50-155" name="__codelineno-50-155"></a><span class="w">            </span><span class="s2">&quot;\tname: back-end\n&quot;</span><span class="p">,</span>
<a id="__codelineno-50-156" name="__codelineno-50-156"></a><span class="w">            </span><span class="s2">&quot;spec:&quot;</span><span class="p">,</span>
<a id="__codelineno-50-157" name="__codelineno-50-157"></a><span class="w">            </span><span class="s2">&quot;\ttype: ClusterIP&quot;</span><span class="p">,</span>
<a id="__codelineno-50-158" name="__codelineno-50-158"></a><span class="w">            </span><span class="s2">&quot;\tports:&quot;</span><span class="p">,</span>
<a id="__codelineno-50-159" name="__codelineno-50-159"></a><span class="w">            </span><span class="s2">&quot;\t\t- targetPort: 80&quot;</span><span class="p">,</span>
<a id="__codelineno-50-160" name="__codelineno-50-160"></a><span class="w">            </span><span class="s2">&quot;\t\t  port: 80\n&quot;</span><span class="p">,</span>
<a id="__codelineno-50-161" name="__codelineno-50-161"></a><span class="w">            </span><span class="s2">&quot;\tselector:&quot;</span><span class="p">,</span>
<a id="__codelineno-50-162" name="__codelineno-50-162"></a><span class="w">            </span><span class="s2">&quot;\t\tapp: my-app&quot;</span><span class="p">,</span>
<a id="__codelineno-50-163" name="__codelineno-50-163"></a><span class="w">            </span><span class="s2">&quot;\t\ttype: back-end\n&quot;</span><span class="p">,</span>
<a id="__codelineno-50-164" name="__codelineno-50-164"></a><span class="w">            </span><span class="s2">&quot;---&quot;</span><span class="p">,</span>
<a id="__codelineno-50-165" name="__codelineno-50-165"></a><span class="w">        </span><span class="p">],</span>
<a id="__codelineno-50-166" name="__codelineno-50-166"></a><span class="w">        </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;k8s ClusterIP&quot;</span>
<a id="__codelineno-50-167" name="__codelineno-50-167"></a><span class="w">    </span><span class="p">},</span>
<a id="__codelineno-50-168" name="__codelineno-50-168"></a>
<a id="__codelineno-50-169" name="__codelineno-50-169"></a><span class="w">    </span><span class="nt">&quot;k8s LoadBalancer&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-50-170" name="__codelineno-50-170"></a><span class="w">        </span><span class="nt">&quot;prefix&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;k-loadbalancer&quot;</span><span class="p">,</span>
<a id="__codelineno-50-171" name="__codelineno-50-171"></a><span class="w">        </span><span class="nt">&quot;body&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<a id="__codelineno-50-172" name="__codelineno-50-172"></a><span class="w">            </span><span class="s2">&quot;apiVersion: v1&quot;</span><span class="p">,</span>
<a id="__codelineno-50-173" name="__codelineno-50-173"></a><span class="w">            </span><span class="s2">&quot;kind: Service&quot;</span><span class="p">,</span>
<a id="__codelineno-50-174" name="__codelineno-50-174"></a><span class="w">            </span><span class="s2">&quot;metadata:&quot;</span><span class="p">,</span>
<a id="__codelineno-50-175" name="__codelineno-50-175"></a><span class="w">            </span><span class="s2">&quot;\tname: back-end\n&quot;</span><span class="p">,</span>
<a id="__codelineno-50-176" name="__codelineno-50-176"></a><span class="w">            </span><span class="s2">&quot;spec:&quot;</span><span class="p">,</span>
<a id="__codelineno-50-177" name="__codelineno-50-177"></a><span class="w">            </span><span class="s2">&quot;\ttype: LoadBalancer&quot;</span><span class="p">,</span>
<a id="__codelineno-50-178" name="__codelineno-50-178"></a><span class="w">            </span><span class="s2">&quot;\tports:&quot;</span><span class="p">,</span>
<a id="__codelineno-50-179" name="__codelineno-50-179"></a><span class="w">            </span><span class="s2">&quot;\t\t- targetPort: 80&quot;</span><span class="p">,</span>
<a id="__codelineno-50-180" name="__codelineno-50-180"></a><span class="w">            </span><span class="s2">&quot;\t\t  port: 80&quot;</span><span class="p">,</span>
<a id="__codelineno-50-181" name="__codelineno-50-181"></a><span class="w">            </span><span class="s2">&quot;\t\t  NodePort: 30008\n&quot;</span><span class="p">,</span>
<a id="__codelineno-50-182" name="__codelineno-50-182"></a><span class="w">            </span><span class="s2">&quot;\tselector:&quot;</span><span class="p">,</span>
<a id="__codelineno-50-183" name="__codelineno-50-183"></a><span class="w">            </span><span class="s2">&quot;\t\tapp: my-app&quot;</span><span class="p">,</span>
<a id="__codelineno-50-184" name="__codelineno-50-184"></a><span class="w">            </span><span class="s2">&quot;\t\ttype: back-end\n&quot;</span><span class="p">,</span>
<a id="__codelineno-50-185" name="__codelineno-50-185"></a><span class="w">            </span><span class="s2">&quot;---&quot;</span><span class="p">,</span>
<a id="__codelineno-50-186" name="__codelineno-50-186"></a><span class="w">        </span><span class="p">],</span>
<a id="__codelineno-50-187" name="__codelineno-50-187"></a><span class="w">        </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;k8s LoadBalancer&quot;</span>
<a id="__codelineno-50-188" name="__codelineno-50-188"></a><span class="w">    </span><span class="p">},</span>
<a id="__codelineno-50-189" name="__codelineno-50-189"></a>
<a id="__codelineno-50-190" name="__codelineno-50-190"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>





                
              </article>
            </div>
          
          
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Retour en haut de la page
          </a>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.tabs", "navigation.top", "navigation.tabs.sticky", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.12658920.min.js", "translations": {"clipboard.copied": "Copi\u00e9 dans le presse-papier", "clipboard.copy": "Copier dans le presse-papier", "search.result.more.one": "1 de plus sur cette page", "search.result.more.other": "# de plus sur cette page", "search.result.none": "Aucun document trouv\u00e9", "search.result.one": "1 document trouv\u00e9", "search.result.other": "# documents trouv\u00e9s", "search.result.placeholder": "Taper pour d\u00e9marrer la recherche", "search.result.term.missing": "Non trouv\u00e9", "select.version": "S\u00e9lectionner la version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.5cf534bf.min.js"></script>
      
        <script src="../../javascripts/config.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>